parcelRequire=function(e,r,n){var t="function"==typeof parcelRequire&&parcelRequire,i="function"==typeof require&&require;function u(n,o){if(!r[n]){if(!e[n]){var f="function"==typeof parcelRequire&&parcelRequire;if(!o&&f)return f(n,!0);if(t)return t(n,!0);if(i&&"string"==typeof n)return i(n);var c=new Error("Cannot find module '"+n+"'");throw c.code="MODULE_NOT_FOUND",c}a.resolve=function(r){return e[n][1][r]||r};var l=r[n]=new u.Module(n);e[n][0].call(l.exports,a,l,l.exports)}return r[n].exports;function a(e){return u(a.resolve(e))}}u.isParcelRequire=!0,u.Module=function(e){this.id=e,this.bundle=u,this.exports={}},u.modules=e,u.cache=r,u.parent=t;for(var o=0;o<n.length;o++)u(n[o]);return u}({8:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.__extends=e,exports.__rest=n,exports.__decorate=o,exports.__param=a,exports.__metadata=c,exports.__awaiter=i,exports.__generator=u,exports.__exportStar=f,exports.__values=l,exports.__read=s,exports.__spread=p,exports.__await=y,exports.__asyncGenerator=_,exports.__asyncDelegator=h,exports.__asyncValues=b,exports.__makeTemplateObject=v,exports.__importStar=d,exports.__importDefault=w;var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};function e(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}var r=exports.__assign=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t};function n(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&(r[n[o]]=t[n[o]])}return r}function o(t,e,r,n){var o,a=arguments.length,c=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,r,n);else for(var i=t.length-1;i>=0;i--)(o=t[i])&&(c=(a<3?o(c):a>3?o(e,r,c):o(e,r))||c);return a>3&&c&&Object.defineProperty(e,r,c),c}function a(t,e){return function(r,n){e(r,n,t)}}function c(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function i(t,e,r,n){return new(r||(r=Promise))(function(o,a){function c(t){try{u(n.next(t))}catch(t){a(t)}}function i(t){try{u(n.throw(t))}catch(t){a(t)}}function u(t){t.done?o(t.value):new r(function(e){e(t.value)}).then(c,i)}u((n=n.apply(t,e||[])).next())})}function u(t,e){var r,n,o,a,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function i(a){return function(i){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;c;)try{if(r=1,n&&(o=n[2&a[0]?"return":a[0]?"throw":"next"])&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[0,o.value]),a[0]){case 0:case 1:o=a;break;case 4:return c.label++,{value:a[1],done:!1};case 5:c.label++,n=a[1],a=[0];continue;case 7:a=c.ops.pop(),c.trys.pop();continue;default:if(!(o=(o=c.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){c=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){c.label=a[1];break}if(6===a[0]&&c.label<o[1]){c.label=o[1],o=a;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(a);break}o[2]&&c.ops.pop(),c.trys.pop();continue}a=e.call(t,c)}catch(t){a=[6,t],n=0}finally{r=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,i])}}}function f(t,e){for(var r in t)e.hasOwnProperty(r)||(e[r]=t[r])}function l(t){var e="function"==typeof Symbol&&t[Symbol.iterator],r=0;return e?e.call(t):{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}}}function s(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,a=r.call(t),c=[];try{for(;(void 0===e||e-- >0)&&!(n=a.next()).done;)c.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return c}function p(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(s(arguments[e]));return t}function y(t){return this instanceof y?(this.v=t,this):new y(t)}function _(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(t,e||[]),a=[];return n={},c("next"),c("throw"),c("return"),n[Symbol.asyncIterator]=function(){return this},n;function c(t){o[t]&&(n[t]=function(e){return new Promise(function(r,n){a.push([t,e,r,n])>1||i(t,e)})})}function i(t,e){try{(r=o[t](e)).value instanceof y?Promise.resolve(r.value.v).then(u,f):l(a[0][2],r)}catch(t){l(a[0][3],t)}var r}function u(t){i("next",t)}function f(t){i("throw",t)}function l(t,e){t(e),a.shift(),a.length&&i(a[0][0],a[0][1])}}function h(t){var e,r;return e={},n("next"),n("throw",function(t){throw t}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(n,o){t[n]&&(e[n]=function(e){return(r=!r)?{value:y(t[n](e)),done:"return"===n}:o?o(e):e})}}function b(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator];return e?e.call(t):"function"==typeof l?l(t):t[Symbol.iterator]()}function v(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function d(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function w(t){return t&&t.__esModule?t:{default:t}}
},{}],6:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=function(){function e(){}return Object.defineProperty(e,"activeLogLevel",{get:function(){return e.instance.activeLogLevel},set:function(t){e.instance.activeLogLevel=t},enumerable:!0,configurable:!0}),Object.defineProperty(e,"instance",{get:function(){return void 0!==e._instance&&null!==e._instance||(e._instance=new t),e._instance},enumerable:!0,configurable:!0}),e.subscribe=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t.map(function(t){return e.instance.subscribe(t)})},e.clearSubscribers=function(){return e.instance.clearSubscribers()},Object.defineProperty(e,"count",{get:function(){return e.instance.count},enumerable:!0,configurable:!0}),e.write=function(t,n){void 0===n&&(n=0),e.instance.log({level:n,message:t})},e.writeJSON=function(t,n){void 0===n&&(n=0),e.instance.log({level:n,message:JSON.stringify(t)})},e.log=function(t){e.instance.log(t)},e.error=function(t){e.instance.log({data:t,level:3,message:t.message})},e}(),t=function(){function e(e,t){void 0===e&&(e=2),void 0===t&&(t=[]),this.activeLogLevel=e,this.subscribers=t}return e.prototype.subscribe=function(e){this.subscribers.push(e)},e.prototype.clearSubscribers=function(){var e=this.subscribers.slice(0);return this.subscribers.length=0,e},Object.defineProperty(e.prototype,"count",{get:function(){return this.subscribers.length},enumerable:!0,configurable:!0}),e.prototype.write=function(e,t){void 0===t&&(t=0),this.log({level:t,message:e})},e.prototype.log=function(e){void 0!==e&&this.activeLogLevel<=e.level&&this.subscribers.map(function(t){return t.log(e)})},e}(),n=function(){function e(){}return e.prototype.log=function(e){var t=this.format(e);switch(e.level){case 0:case 1:console.log(t);break;case 2:console.warn(t);break;case 3:console.error(t)}},e.prototype.format=function(e){var t=[];return t.push("Message: "+e.message),void 0!==e.data&&t.push(" Data: "+JSON.stringify(e.data)),t.join("")},e}(),r=function(){function e(e){this.method=e}return e.prototype.log=function(e){this.method(e)},e}();exports.Logger=e,exports.ConsoleListener=n,exports.FunctionListener=r;
},{}],14:[function(require,module,exports) {
var e=function(){"use strict";return e=function(t){if(this.REQUEST_TYPE={LOGIN:"LOGIN",RENEW_TOKEN:"RENEW_TOKEN",UNKNOWN:"UNKNOWN"},this.RESPONSE_TYPE={ID_TOKEN_TOKEN:"id_token token",TOKEN:"token"},this.CONSTANTS={ACCESS_TOKEN:"access_token",EXPIRES_IN:"expires_in",ID_TOKEN:"id_token",ERROR_DESCRIPTION:"error_description",SESSION_STATE:"session_state",ERROR:"error",STORAGE:{TOKEN_KEYS:"adal.token.keys",ACCESS_TOKEN_KEY:"adal.access.token.key",EXPIRATION_KEY:"adal.expiration.key",STATE_LOGIN:"adal.state.login",STATE_RENEW:"adal.state.renew",NONCE_IDTOKEN:"adal.nonce.idtoken",SESSION_STATE:"adal.session.state",USERNAME:"adal.username",IDTOKEN:"adal.idtoken",ERROR:"adal.error",ERROR_DESCRIPTION:"adal.error.description",LOGIN_REQUEST:"adal.login.request",LOGIN_ERROR:"adal.login.error",RENEW_STATUS:"adal.token.renew.status",ANGULAR_LOGIN_REQUEST:"adal.angular.login.request"},RESOURCE_DELIMETER:"|",CACHE_DELIMETER:"||",LOADFRAME_TIMEOUT:6e3,TOKEN_RENEW_STATUS_CANCELED:"Canceled",TOKEN_RENEW_STATUS_COMPLETED:"Completed",TOKEN_RENEW_STATUS_IN_PROGRESS:"In Progress",LOGGING_LEVEL:{ERROR:0,WARN:1,INFO:2,VERBOSE:3},LEVEL_STRING_MAP:{0:"ERROR:",1:"WARNING:",2:"INFO:",3:"VERBOSE:"},POPUP_WIDTH:483,POPUP_HEIGHT:600},e.prototype._singletonInstance)return e.prototype._singletonInstance;if(e.prototype._singletonInstance=this,this.instance="https://login.microsoftonline.com/",this.config={},this.callback=null,this.popUp=!1,this.isAngular=!1,this._user=null,this._activeRenewals={},this._loginInProgress=!1,this._acquireTokenInProgress=!1,this._renewStates=[],this._callBackMappedToRenewStates={},this._callBacksMappedToRenewStates={},this._openedWindows=[],this._requestType=this.REQUEST_TYPE.LOGIN,window._adalInstance=this,t.displayCall&&"function"!=typeof t.displayCall)throw new Error("displayCall is not a function");if(!t.clientId)throw new Error("clientId is required");this.config=this._cloneConfig(t),void 0===this.config.navigateToLoginRequestUrl&&(this.config.navigateToLoginRequestUrl=!0),this.config.popUp&&(this.popUp=!0),this.config.callback&&"function"==typeof this.config.callback&&(this.callback=this.config.callback),this.config.instance&&(this.instance=this.config.instance),this.config.loginResource||(this.config.loginResource=this.config.clientId),this.config.redirectUri||(this.config.redirectUri=window.location.href.split("?")[0].split("#")[0]),this.config.postLogoutRedirectUri||(this.config.postLogoutRedirectUri=window.location.href.split("?")[0].split("#")[0]),this.config.anonymousEndpoints||(this.config.anonymousEndpoints=[]),this.config.isAngular&&(this.isAngular=this.config.isAngular),this.config.loadFrameTimeout&&(this.CONSTANTS.LOADFRAME_TIMEOUT=this.config.loadFrameTimeout)},"undefined"!=typeof window&&(window.Logging={piiLoggingEnabled:!1,level:0,log:function(e){}}),e.prototype.login=function(){if(this._loginInProgress)this.info("Login in progress");else{this._loginInProgress=!0;var e=this._guid();this.config.state=e,this._idTokenNonce=this._guid();var t=this._getItem(this.CONSTANTS.STORAGE.ANGULAR_LOGIN_REQUEST);t&&""!==t?this._saveItem(this.CONSTANTS.STORAGE.ANGULAR_LOGIN_REQUEST,""):t=window.location.href,this.verbose("Expected state: "+e+" startPage:"+t),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,t),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,e,!0),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce,!0),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"");var i=this._getNavigateUrl("id_token",null)+"&nonce="+encodeURIComponent(this._idTokenNonce);this.config.displayCall?this.config.displayCall(i):this.popUp?(this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,""),this._renewStates.push(e),this.registerCallback(e,this.config.clientId,this.callback),this._loginPopup(i)):this.promptUser(i)}},e.prototype._openPopup=function(e,t,i,s){try{var o=window.screenLeft?window.screenLeft:window.screenX,n=window.screenTop?window.screenTop:window.screenY,r=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,a=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,h=r/2-i/2+o,T=a/2-s/2+n,c=window.open(e,t,"width="+i+", height="+s+", top="+T+", left="+h);return c.focus&&c.focus(),c}catch(e){return this.warn("Error opening popup, "+e.message),this._loginInProgress=!1,this._acquireTokenInProgress=!1,null}},e.prototype._handlePopupError=function(e,t,i,s,o){this.warn(s),this._saveItem(this.CONSTANTS.STORAGE.ERROR,i),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,s),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,o),t&&this._activeRenewals[t]&&(this._activeRenewals[t]=null),this._loginInProgress=!1,this._acquireTokenInProgress=!1,e&&e(s,null,i)},e.prototype._loginPopup=function(e,t,i){var s=this._openPopup(e,"login",this.CONSTANTS.POPUP_WIDTH,this.CONSTANTS.POPUP_HEIGHT),o=i||this.callback;if(null!=s){if(this._openedWindows.push(s),-1!=this.config.redirectUri.indexOf("#"))var n=this.config.redirectUri.split("#")[0];else n=this.config.redirectUri;var r=this,a=window.setInterval(function(){if(!s||s.closed||void 0===s.closed){var e="Popup Window closed",i="Popup Window closed by UI action/ Popup Window handle destroyed due to cross zone navigation in IE/Edge";return r.isAngular&&r._broadcast("adal:popUpClosed",i+r.CONSTANTS.RESOURCE_DELIMETER+e),r._handlePopupError(o,t,e,i,i),void window.clearInterval(a)}try{var h=s.location;if(-1!=encodeURI(h.href).indexOf(encodeURI(n)))return r.isAngular?r._broadcast("adal:popUpHashChanged",h.hash):r.handleWindowCallback(h.hash),window.clearInterval(a),r._loginInProgress=!1,r._acquireTokenInProgress=!1,r.info("Closing popup window"),r._openedWindows=[],void s.close()}catch(e){}},1)}else{var h="Popup Window is null. This can happen if you are using IE";this._handlePopupError(o,t,"Error opening popup",h,h)}},e.prototype._broadcast=function(e,t){!function(){if("function"==typeof window.CustomEvent)return!1;function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var i=document.createEvent("CustomEvent");return i.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),i}e.prototype=window.Event.prototype,window.CustomEvent=e}();var i=new CustomEvent(e,{detail:t});window.dispatchEvent(i)},e.prototype.loginInProgress=function(){return this._loginInProgress},e.prototype._hasResource=function(e){var t=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS);return t&&!this._isEmpty(t)&&t.indexOf(e+this.CONSTANTS.RESOURCE_DELIMETER)>-1},e.prototype.getCachedToken=function(e){if(!this._hasResource(e))return null;var t=this._getItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+e),i=this._getItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+e),s=this.config.expireOffsetSeconds||300;return i&&i>this._now()+s?t:(this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+e,""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+e,0),null)},e.prototype.getCachedUser=function(){if(this._user)return this._user;var e=this._getItem(this.CONSTANTS.STORAGE.IDTOKEN);return this._user=this._createUser(e),this._user},e.prototype.registerCallback=function(e,t,i){this._activeRenewals[t]=e,this._callBacksMappedToRenewStates[e]||(this._callBacksMappedToRenewStates[e]=[]);var s=this;this._callBacksMappedToRenewStates[e].push(i),this._callBackMappedToRenewStates[e]||(this._callBackMappedToRenewStates[e]=function(i,o,n,r){s._activeRenewals[t]=null;for(var a=0;a<s._callBacksMappedToRenewStates[e].length;++a)try{s._callBacksMappedToRenewStates[e][a](i,o,n,r)}catch(n){s.warn(n)}s._callBacksMappedToRenewStates[e]=null,s._callBackMappedToRenewStates[e]=null})},e.prototype._renewToken=function(e,t,i){this.info("renewToken is called for resource:"+e);var s=this._addAdalFrame("adalRenewFrame"+e),o=this._guid()+"|"+e;this.config.state=o,this._renewStates.push(o),this.verbose("Renew token Expected state: "+o),i=i||"token";var n=this._urlRemoveQueryStringParameter(this._getNavigateUrl(i,e),"prompt");i===this.RESPONSE_TYPE.ID_TOKEN_TOKEN&&(this._idTokenNonce=this._guid(),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce,!0),n+="&nonce="+encodeURIComponent(this._idTokenNonce)),n+="&prompt=none",n=this._addHintParameters(n),this.registerCallback(o,e,t),this.verbosePii("Navigate to:"+n),s.src="about:blank",this._loadFrameTimeout(n,"adalRenewFrame"+e,e)},e.prototype._renewIdToken=function(e,t){this.info("renewIdToken is called");var i=this._addAdalFrame("adalIdTokenFrame"),s=this._guid()+"|"+this.config.clientId;this._idTokenNonce=this._guid(),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce,!0),this.config.state=s,this._renewStates.push(s),this.verbose("Renew Idtoken Expected state: "+s);var o=null===t||void 0===t?null:this.config.clientId,n=(t=t||"id_token",this._urlRemoveQueryStringParameter(this._getNavigateUrl(t,o),"prompt"));n+="&prompt=none",n=this._addHintParameters(n),n+="&nonce="+encodeURIComponent(this._idTokenNonce),this.registerCallback(s,this.config.clientId,e),this.verbosePii("Navigate to:"+n),i.src="about:blank",this._loadFrameTimeout(n,"adalIdTokenFrame",this.config.clientId)},e.prototype._urlContainsQueryStringParameter=function(e,t){return new RegExp("[\\?&]"+e+"=").test(t)},e.prototype._urlRemoveQueryStringParameter=function(e,t){var i=new RegExp("(\\&"+t+"=)[^&]+");return e=e.replace(i,""),i=new RegExp("("+t+"=)[^&]+&"),e=e.replace(i,""),i=new RegExp("("+t+"=)[^&]+"),e=e.replace(i,"")},e.prototype._loadFrameTimeout=function(e,t,i){this.verbose("Set loading state to pending for: "+i),this._saveItem(this.CONSTANTS.STORAGE.RENEW_STATUS+i,this.CONSTANTS.TOKEN_RENEW_STATUS_IN_PROGRESS),this._loadFrame(e,t);var s=this;setTimeout(function(){if(s._getItem(s.CONSTANTS.STORAGE.RENEW_STATUS+i)===s.CONSTANTS.TOKEN_RENEW_STATUS_IN_PROGRESS){s.verbose("Loading frame has timed out after: "+s.CONSTANTS.LOADFRAME_TIMEOUT/1e3+" seconds for resource "+i);var e=s._activeRenewals[i];e&&s._callBackMappedToRenewStates[e]&&s._callBackMappedToRenewStates[e]("Token renewal operation failed due to timeout",null,"Token Renewal Failed"),s._saveItem(s.CONSTANTS.STORAGE.RENEW_STATUS+i,s.CONSTANTS.TOKEN_RENEW_STATUS_CANCELED)}},s.CONSTANTS.LOADFRAME_TIMEOUT)},e.prototype._loadFrame=function(e,t){var i=this;i.info("LoadFrame: "+t);var s=t;setTimeout(function(){var t=i._addAdalFrame(s);""!==t.src&&"about:blank"!==t.src||(t.src=e,i._loadFrame(e,s))},500)},e.prototype.acquireToken=function(e,t){if(this._isEmpty(e))return this.warn("resource is required"),void t("resource is required",null,"resource is required");var i=this.getCachedToken(e);return i?(this.info("Token is already in cache for resource:"+e),void t(null,i,null)):this._user||this.config.extraQueryParameter&&-1!==this.config.extraQueryParameter.indexOf("login_hint")?void(this._activeRenewals[e]?this.registerCallback(this._activeRenewals[e],e,t):(this._requestType=this.REQUEST_TYPE.RENEW_TOKEN,e===this.config.clientId?this._user?(this.verbose("renewing idtoken"),this._renewIdToken(t)):(this.verbose("renewing idtoken and access_token"),this._renewIdToken(t,this.RESPONSE_TYPE.ID_TOKEN_TOKEN)):this._user?(this.verbose("renewing access_token"),this._renewToken(e,t)):(this.verbose("renewing idtoken and access_token"),this._renewToken(e,t,this.RESPONSE_TYPE.ID_TOKEN_TOKEN)))):(this.warn("User login is required"),void t("User login is required",null,"login required"))},e.prototype.acquireTokenPopup=function(e,t,i,s){if(this._isEmpty(e))return this.warn("resource is required"),void s("resource is required",null,"resource is required");if(!this._user)return this.warn("User login is required"),void s("User login is required",null,"login required");if(this._acquireTokenInProgress)return this.warn("Acquire token interactive is already in progress"),void s("Acquire token interactive is already in progress",null,"Acquire token interactive is already in progress");var o=this._guid()+"|"+e;this.config.state=o,this._renewStates.push(o),this._requestType=this.REQUEST_TYPE.RENEW_TOKEN,this.verbose("Renew token Expected state: "+o);var n=this._urlRemoveQueryStringParameter(this._getNavigateUrl("token",e),"prompt");if(n+="&prompt=select_account",t&&(n+=t),i&&-1===n.indexOf("&claims"))n+="&claims="+encodeURIComponent(i);else if(i&&-1!==n.indexOf("&claims"))throw new Error("Claims cannot be passed as an extraQueryParameter");n=this._addHintParameters(n),this._acquireTokenInProgress=!0,this.info("acquireToken interactive is called for the resource "+e),this.registerCallback(o,e,s),this._loginPopup(n,e,s)},e.prototype.acquireTokenRedirect=function(e,t,i){if(this._isEmpty(e))return this.warn("resource is required"),void s("resource is required",null,"resource is required");var s=this.callback;if(!this._user)return this.warn("User login is required"),void s("User login is required",null,"login required");if(this._acquireTokenInProgress)return this.warn("Acquire token interactive is already in progress"),void s("Acquire token interactive is already in progress",null,"Acquire token interactive is already in progress");var o=this._guid()+"|"+e;this.config.state=o,this.verbose("Renew token Expected state: "+o);var n=this._urlRemoveQueryStringParameter(this._getNavigateUrl("token",e),"prompt");if(n+="&prompt=select_account",t&&(n+=t),i&&-1===n.indexOf("&claims"))n+="&claims="+encodeURIComponent(i);else if(i&&-1!==n.indexOf("&claims"))throw new Error("Claims cannot be passed as an extraQueryParameter");n=this._addHintParameters(n),this._acquireTokenInProgress=!0,this.info("acquireToken interactive is called for the resource "+e),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,window.location.href),this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,o,!0),this.promptUser(n)},e.prototype.promptUser=function(e){e?(this.infoPii("Navigate to:"+e),window.location.replace(e)):this.info("Navigate url is empty")},e.prototype.clearCache=function(){this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,""),this._saveItem(this.CONSTANTS.STORAGE.ANGULAR_LOGIN_REQUEST,""),this._saveItem(this.CONSTANTS.STORAGE.SESSION_STATE,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,""),this._renewStates=[],this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,""),this._saveItem(this.CONSTANTS.STORAGE.IDTOKEN,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,""),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,"");var e=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS);if(!this._isEmpty(e)){e=e.split(this.CONSTANTS.RESOURCE_DELIMETER);for(var t=0;t<e.length&&""!==e[t];t++)this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+e[t],""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+e[t],0)}this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,"")},e.prototype.clearCacheForResource=function(e){this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,""),this._hasResource(e)&&(this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+e,""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+e,0))},e.prototype.logOut=function(){var e;if(this.clearCache(),this._user=null,this.config.logOutUri)e=this.config.logOutUri;else{var t="common",i="";this.config.tenant&&(t=this.config.tenant),this.config.postLogoutRedirectUri&&(i="post_logout_redirect_uri="+encodeURIComponent(this.config.postLogoutRedirectUri)),e=this.instance+t+"/oauth2/logout?"+i}this.infoPii("Logout navigate to: "+e),this.promptUser(e)},e.prototype._isEmpty=function(e){return void 0===e||!e||0===e.length},e.prototype.getUser=function(e){if("function"!=typeof e)throw new Error("callback is not a function");if(this._user)e(null,this._user);else{var t=this._getItem(this.CONSTANTS.STORAGE.IDTOKEN);this._isEmpty(t)?(this.warn("User information is not available"),e("User information is not available",null)):(this.info("User exists in cache: "),this._user=this._createUser(t),e(null,this._user))}},e.prototype._addHintParameters=function(e){if(this._user&&this._user.profile)if(this._user.profile.sid&&-1!==e.indexOf("&prompt=none"))this._urlContainsQueryStringParameter("sid",e)||(e+="&sid="+encodeURIComponent(this._user.profile.sid));else if(this._user.profile.upn&&(this._urlContainsQueryStringParameter("login_hint",e)||(e+="&login_hint="+encodeURIComponent(this._user.profile.upn)),!this._urlContainsQueryStringParameter("domain_hint",e)&&this._user.profile.upn.indexOf("@")>-1)){var t=this._user.profile.upn.split("@");e+="&domain_hint="+encodeURIComponent(t[t.length-1])}return e},e.prototype._createUser=function(e){var t=null,i=this._extractIdToken(e);return i&&i.hasOwnProperty("aud")&&(i.aud.toLowerCase()===this.config.clientId.toLowerCase()?(t={userName:"",profile:i},i.hasOwnProperty("upn")?t.userName=i.upn:i.hasOwnProperty("email")&&(t.userName=i.email)):this.warn("IdToken has invalid aud field")),t},e.prototype._getHash=function(e){return e.indexOf("#/")>-1?e=e.substring(e.indexOf("#/")+2):e.indexOf("#")>-1&&(e=e.substring(1)),e},e.prototype.isCallback=function(e){e=this._getHash(e);var t=this._deserialize(e);return t.hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION)||t.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)||t.hasOwnProperty(this.CONSTANTS.ID_TOKEN)},e.prototype.getLoginError=function(){return this._getItem(this.CONSTANTS.STORAGE.LOGIN_ERROR)},e.prototype.getRequestInfo=function(e){e=this._getHash(e);var t=this._deserialize(e),i={valid:!1,parameters:{},stateMatch:!1,stateResponse:"",requestType:this.REQUEST_TYPE.UNKNOWN};if(t&&(i.parameters=t,t.hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION)||t.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)||t.hasOwnProperty(this.CONSTANTS.ID_TOKEN))){i.valid=!0;var s="";if(!t.hasOwnProperty("state"))return this.warn("No state returned"),i;if(this.verbose("State: "+t.state),s=t.state,i.stateResponse=s,this._matchState(i))return i;if(!i.stateMatch&&window.parent){i.requestType=this._requestType;for(var o=this._renewStates,n=0;n<o.length;n++)if(o[n]===i.stateResponse){i.stateMatch=!0;break}}}return i},e.prototype._matchNonce=function(e){var t=this._getItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN);if(t){t=t.split(this.CONSTANTS.CACHE_DELIMETER);for(var i=0;i<t.length;i++)if(t[i]===e.profile.nonce)return!0}return!1},e.prototype._matchState=function(e){var t=this._getItem(this.CONSTANTS.STORAGE.STATE_LOGIN);if(t){t=t.split(this.CONSTANTS.CACHE_DELIMETER);for(var i=0;i<t.length;i++)if(t[i]===e.stateResponse)return e.requestType=this.REQUEST_TYPE.LOGIN,e.stateMatch=!0,!0}var s=this._getItem(this.CONSTANTS.STORAGE.STATE_RENEW);if(s){s=s.split(this.CONSTANTS.CACHE_DELIMETER);for(i=0;i<s.length;i++)if(s[i]===e.stateResponse)return e.requestType=this.REQUEST_TYPE.RENEW_TOKEN,e.stateMatch=!0,!0}return!1},e.prototype._getResourceFromState=function(e){if(e){var t=e.indexOf("|");if(t>-1&&t+1<e.length)return e.substring(t+1)}return""},e.prototype.saveTokenFromHash=function(e){this.info("State status:"+e.stateMatch+"; Request type:"+e.requestType),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"");var t,i=this._getResourceFromState(e.stateResponse);e.parameters.hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION)?(this.infoPii("Error :"+e.parameters.error+"; Error description:"+e.parameters[this.CONSTANTS.ERROR_DESCRIPTION]),this._saveItem(this.CONSTANTS.STORAGE.ERROR,e.parameters.error),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,e.parameters[this.CONSTANTS.ERROR_DESCRIPTION]),e.requestType===this.REQUEST_TYPE.LOGIN&&(this._loginInProgress=!1,this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,e.parameters.error_description))):e.stateMatch?(this.info("State is right"),e.parameters.hasOwnProperty(this.CONSTANTS.SESSION_STATE)&&this._saveItem(this.CONSTANTS.STORAGE.SESSION_STATE,e.parameters[this.CONSTANTS.SESSION_STATE]),e.parameters.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)&&(this.info("Fragment has access token"),this._hasResource(i)||(t=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS)||"",this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,t+i+this.CONSTANTS.RESOURCE_DELIMETER)),this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+i,e.parameters[this.CONSTANTS.ACCESS_TOKEN]),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+i,this._expiresIn(e.parameters[this.CONSTANTS.EXPIRES_IN]))),e.parameters.hasOwnProperty(this.CONSTANTS.ID_TOKEN)&&(this.info("Fragment has id token"),this._loginInProgress=!1,this._user=this._createUser(e.parameters[this.CONSTANTS.ID_TOKEN]),this._user&&this._user.profile?this._matchNonce(this._user)?(this._saveItem(this.CONSTANTS.STORAGE.IDTOKEN,e.parameters[this.CONSTANTS.ID_TOKEN]),i=this.config.loginResource?this.config.loginResource:this.config.clientId,this._hasResource(i)||(t=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS)||"",this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,t+i+this.CONSTANTS.RESOURCE_DELIMETER)),this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+i,e.parameters[this.CONSTANTS.ID_TOKEN]),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+i,this._user.profile.exp)):(this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,"Nonce received: "+this._user.profile.nonce+" is not same as requested: "+this._getItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN)),this._user=null):(e.parameters.error="invalid id_token",e.parameters.error_description="Invalid id_token. id_token: "+e.parameters[this.CONSTANTS.ID_TOKEN],this._saveItem(this.CONSTANTS.STORAGE.ERROR,"invalid id_token"),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"Invalid id_token. id_token: "+e.parameters[this.CONSTANTS.ID_TOKEN])))):(e.parameters.error="Invalid_state",e.parameters.error_description="Invalid_state. state: "+e.stateResponse,this._saveItem(this.CONSTANTS.STORAGE.ERROR,"Invalid_state"),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"Invalid_state. state: "+e.stateResponse));this._saveItem(this.CONSTANTS.STORAGE.RENEW_STATUS+i,this.CONSTANTS.TOKEN_RENEW_STATUS_COMPLETED)},e.prototype.getResourceForEndpoint=function(e){if(this.config&&this.config.anonymousEndpoints)for(var t=0;t<this.config.anonymousEndpoints.length;t++)if(e.indexOf(this.config.anonymousEndpoints[t])>-1)return null;if(this.config&&this.config.endpoints)for(var i in this.config.endpoints)if(e.indexOf(i)>-1)return this.config.endpoints[i];return e.indexOf("http://")>-1||e.indexOf("https://")>-1?this._getHostFromUri(e)===this._getHostFromUri(this.config.redirectUri)?this.config.loginResource:null:this.config.loginResource},e.prototype._getHostFromUri=function(e){var t=String(e).replace(/^(https?:)\/\//,"");return t=t.split("/")[0]},e.prototype.handleWindowCallback=function(e){if(null==e&&(e=window.location.hash),this.isCallback(e)){var t=null,i=!1;this._openedWindows.length>0&&this._openedWindows[this._openedWindows.length-1].opener&&this._openedWindows[this._openedWindows.length-1].opener._adalInstance?(t=this._openedWindows[this._openedWindows.length-1].opener._adalInstance,i=!0):window.parent&&window.parent._adalInstance&&(t=window.parent._adalInstance);var s,o,n=t.getRequestInfo(e),r=null;o=i||window.parent!==window?t._callBackMappedToRenewStates[n.stateResponse]:t.callback,t.info("Returned from redirect url"),t.saveTokenFromHash(n),n.requestType===this.REQUEST_TYPE.RENEW_TOKEN&&window.parent?(window.parent!==window?t.verbose("Window is in iframe, acquiring token silently"):t.verbose("acquiring token interactive in progress"),s=n.parameters[t.CONSTANTS.ACCESS_TOKEN]||n.parameters[t.CONSTANTS.ID_TOKEN],r=t.CONSTANTS.ACCESS_TOKEN):n.requestType===this.REQUEST_TYPE.LOGIN&&(s=n.parameters[t.CONSTANTS.ID_TOKEN],r=t.CONSTANTS.ID_TOKEN);var a=n.parameters[t.CONSTANTS.ERROR_DESCRIPTION],h=n.parameters[t.CONSTANTS.ERROR];try{o&&o(a,s,h,r)}catch(e){t.error("Error occurred in user defined callback function: "+e)}window.parent!==window||i||(t.config.navigateToLoginRequestUrl?window.location.href=t._getItem(t.CONSTANTS.STORAGE.LOGIN_REQUEST):window.location.hash="")}},e.prototype._getNavigateUrl=function(e,t){var i="common";this.config.tenant&&(i=this.config.tenant);var s=this.instance+i+"/oauth2/authorize"+this._serialize(e,this.config,t)+this._addLibMetadata();return this.info("Navigate url:"+s),s},e.prototype._extractIdToken=function(e){var t=this._decodeJwt(e);if(!t)return null;try{var i=t.JWSPayload,s=this._base64DecodeStringUrlSafe(i);return s?JSON.parse(s):(this.info("The returned id_token could not be base64 url safe decoded."),null)}catch(e){this.error("The returned id_token could not be decoded",e)}return null},e.prototype._base64DecodeStringUrlSafe=function(e){return e=e.replace(/-/g,"+").replace(/_/g,"/"),window.atob?decodeURIComponent(escape(window.atob(e))):decodeURIComponent(escape(this._decode(e)))},e.prototype._decode=function(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i=(e=String(e).replace(/=+$/,"")).length;if(i%4==1)throw new Error("The token to be decoded is not correctly encoded.");for(var s,o,n,r,a,h,T,c,l="",S=0;S<i;S+=4){if(s=t.indexOf(e.charAt(S)),o=t.indexOf(e.charAt(S+1)),n=t.indexOf(e.charAt(S+2)),r=t.indexOf(e.charAt(S+3)),S+2===i-1){h=(a=s<<18|o<<12|n<<6)>>16&255,T=a>>8&255,l+=String.fromCharCode(h,T);break}if(S+1===i-1){h=(a=s<<18|o<<12)>>16&255,l+=String.fromCharCode(h);break}h=(a=s<<18|o<<12|n<<6|r)>>16&255,T=a>>8&255,c=255&a,l+=String.fromCharCode(h,T,c)}return l},e.prototype._decodeJwt=function(e){if(this._isEmpty(e))return null;var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);return!t||t.length<4?(this.warn("The returned id_token is not parseable."),null):{header:t[1],JWSPayload:t[2],JWSSig:t[3]}},e.prototype._convertUrlSafeToRegularBase64EncodedString=function(e){return e.replace("-","+").replace("_","/")},e.prototype._serialize=function(e,t,i){var s=[];if(null!==t){s.push("?response_type="+e),s.push("client_id="+encodeURIComponent(t.clientId)),i&&s.push("resource="+encodeURIComponent(i)),s.push("redirect_uri="+encodeURIComponent(t.redirectUri)),s.push("state="+encodeURIComponent(t.state)),t.hasOwnProperty("slice")&&s.push("slice="+encodeURIComponent(t.slice)),t.hasOwnProperty("extraQueryParameter")&&s.push(t.extraQueryParameter);var o=t.correlationId?t.correlationId:this._guid();s.push("client-request-id="+encodeURIComponent(o))}return s.join("&")},e.prototype._deserialize=function(e){var t,i=/\+/g,s=/([^&=]+)=([^&]*)/g,o=function(e){return decodeURIComponent(e.replace(i," "))},n={};for(t=s.exec(e);t;)n[o(t[1])]=o(t[2]),t=s.exec(e);return n},e.prototype._decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},e.prototype._guid=function(){var e=window.crypto||window.msCrypto;if(e&&e.getRandomValues){var t=new Uint8Array(16);return e.getRandomValues(t),t[6]|=64,t[6]&=79,t[8]|=128,t[8]&=191,this._decimalToHex(t[0])+this._decimalToHex(t[1])+this._decimalToHex(t[2])+this._decimalToHex(t[3])+"-"+this._decimalToHex(t[4])+this._decimalToHex(t[5])+"-"+this._decimalToHex(t[6])+this._decimalToHex(t[7])+"-"+this._decimalToHex(t[8])+this._decimalToHex(t[9])+"-"+this._decimalToHex(t[10])+this._decimalToHex(t[11])+this._decimalToHex(t[12])+this._decimalToHex(t[13])+this._decimalToHex(t[14])+this._decimalToHex(t[15])}for(var i="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",s="0123456789abcdef",o=0,n="",r=0;r<36;r++)"-"!==i[r]&&"4"!==i[r]&&(o=16*Math.random()|0),"x"===i[r]?n+=s[o]:"y"===i[r]?(o&=3,n+=s[o|=8]):n+=i[r];return n},e.prototype._expiresIn=function(e){return e||(e=3599),this._now()+parseInt(e,10)},e.prototype._now=function(){return Math.round((new Date).getTime()/1e3)},e.prototype._addAdalFrame=function(e){if(void 0!==e){this.info("Add adal frame to document:"+e);var t=document.getElementById(e);if(!t){if(document.createElement&&document.documentElement&&(window.opera||-1===window.navigator.userAgent.indexOf("MSIE 5.0"))){var i=document.createElement("iframe");i.setAttribute("id",e),i.setAttribute("aria-hidden","true"),i.style.visibility="hidden",i.style.position="absolute",i.style.width=i.style.height=i.borderWidth="0px",t=document.getElementsByTagName("body")[0].appendChild(i)}else document.body&&document.body.insertAdjacentHTML&&document.body.insertAdjacentHTML("beforeEnd",'<iframe name="'+e+'" id="'+e+'" style="display:none"></iframe>');window.frames&&window.frames[e]&&(t=window.frames[e])}return t}},e.prototype._saveItem=function(e,t,i){if(this.config&&this.config.cacheLocation&&"localStorage"===this.config.cacheLocation){if(!this._supportsLocalStorage())return this.info("Local storage is not supported"),!1;if(i){var s=this._getItem(e)||"";localStorage.setItem(e,s+t+this.CONSTANTS.CACHE_DELIMETER)}else localStorage.setItem(e,t);return!0}return this._supportsSessionStorage()?(sessionStorage.setItem(e,t),!0):(this.info("Session storage is not supported"),!1)},e.prototype._getItem=function(e){return this.config&&this.config.cacheLocation&&"localStorage"===this.config.cacheLocation?this._supportsLocalStorage()?localStorage.getItem(e):(this.info("Local storage is not supported"),null):this._supportsSessionStorage()?sessionStorage.getItem(e):(this.info("Session storage is not supported"),null)},e.prototype._supportsLocalStorage=function(){try{return!!window.localStorage&&(window.localStorage.setItem("storageTest","A"),"A"==window.localStorage.getItem("storageTest")&&(window.localStorage.removeItem("storageTest"),!window.localStorage.getItem("storageTest")))}catch(e){return!1}},e.prototype._supportsSessionStorage=function(){try{return!!window.sessionStorage&&(window.sessionStorage.setItem("storageTest","A"),"A"==window.sessionStorage.getItem("storageTest")&&(window.sessionStorage.removeItem("storageTest"),!window.sessionStorage.getItem("storageTest")))}catch(e){return!1}},e.prototype._cloneConfig=function(e){if(null===e||"object"!=typeof e)return e;var t={};for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t},e.prototype._addLibMetadata=function(){return"&x-client-SKU=Js&x-client-Ver="+this._libVersion()},e.prototype.log=function(e,t,i,s){if(e<=Logging.level){if(!Logging.piiLoggingEnabled&&s)return;var o=(new Date).toUTCString(),n="";n=this.config.correlationId?o+":"+this.config.correlationId+"-"+this._libVersion()+"-"+this.CONSTANTS.LEVEL_STRING_MAP[e]+" "+t:o+":"+this._libVersion()+"-"+this.CONSTANTS.LEVEL_STRING_MAP[e]+" "+t,i&&(n+="\nstack:\n"+i.stack),Logging.log(n)}},e.prototype.error=function(e,t){this.log(this.CONSTANTS.LOGGING_LEVEL.ERROR,e,t)},e.prototype.warn=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.WARN,e,null)},e.prototype.info=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.INFO,e,null)},e.prototype.verbose=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.VERBOSE,e,null)},e.prototype.errorPii=function(e,t){this.log(this.CONSTANTS.LOGGING_LEVEL.ERROR,e,t,!0)},e.prototype.warnPii=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.WARN,e,null,!0)},e.prototype.infoPii=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.INFO,e,null,!0)},e.prototype.verbosePii=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.VERBOSE,e,null,!0)},e.prototype._libVersion=function(){return"1.0.17"},"undefined"!=typeof module&&module.exports&&(module.exports=e,module.exports.inject=function(t){return new e(t)}),e}();
},{}],7:[function(require,module,exports) {
var global = (1,eval)("this");
var e=(0,eval)("this");Object.defineProperty(exports,"__esModule",{value:!0}),exports.Util=exports.stringIsNullOrEmpty=exports.isUrlAbsolute=exports.extend=exports.isArray=exports.objectDefinedNotNull=exports.isFunc=exports.getGUID=exports.getRandomString=exports.combinePaths=exports.dateAdd=exports.getCtxCallback=exports.PnPClientStorage=exports.PnPClientStorageWrapper=exports.BearerTokenFetchClient=exports.FetchClient=exports.mergeOptions=exports.mergeHeaders=exports.RuntimeConfig=exports.RuntimeConfigImpl=exports.setup=exports.UrlException=exports.beta=exports.deprecated=exports.Dictionary=exports.readBlobAsArrayBuffer=exports.readBlobAsText=exports.AdalClient=void 0;var t=require("tslib"),n=require("adal-angular"),r=require("@pnp/logging");function o(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return function(){t.apply(e,n)}}function i(e,t,n){var r=new Date(e);switch(t.toLowerCase()){case"year":r.setFullYear(r.getFullYear()+n);break;case"quarter":r.setMonth(r.getMonth()+3*n);break;case"month":r.setMonth(r.getMonth()+n);break;case"week":r.setDate(r.getDate()+7*n);break;case"day":r.setDate(r.getDate()+n);break;case"hour":r.setTime(r.getTime()+36e5*n);break;case"minute":r.setTime(r.getTime()+6e4*n);break;case"second":r.setTime(r.getTime()+1e3*n);break;default:r=void 0}return r}function a(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.filter(function(e){return!d(e)}).map(function(e){return e.replace(/^[\\|\/]/,"").replace(/[\\|\/]$/,"")}).join("/").replace(/\\/g,"/")}function s(e){for(var t=new Array(e),n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=0;r<e;r++)t[r]=n.charAt(Math.floor(Math.random()*n.length));return t.join("")}function u(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)})}function l(e){return"function"==typeof e}function c(e){return void 0!==e&&null!==e}function p(e){return Array.isArray?Array.isArray(e):e&&"number"==typeof e.length&&e.constructor===Array}function f(e,t,n){if(void 0===n&&(n=!1),!c(t))return e;var r=n?function(e,t){return!(t in e)}:function(){return!0};return Object.getOwnPropertyNames(t).filter(function(t){return r(e,t)}).reduce(function(e,n){return e[n]=t[n],e},e)}function h(e){return/^https?:\/\/|^\/\//i.test(e)}function d(e){return void 0===e||null===e||e.length<1}var g=function(){function e(){}return e.getCtxCallback=o,e.dateAdd=i,e.combinePaths=a,e.getRandomString=s,e.getGUID=u,e.isFunc=l,e.objectDefinedNotNull=c,e.isArray=p,e.extend=f,e.isUrlAbsolute=h,e.stringIsNullOrEmpty=d,e}();function x(e,t){void 0!==t&&null!==t&&new Request("",{headers:t}).headers.forEach(function(t,n){e.append(n,t)})}function y(e,t){if(c(t)){var n=f(e.headers||{},t.headers);(e=f(e,t)).headers=n}}var v=function(){function t(){}return t.prototype.fetch=function(t,n){return e.fetch(t,n)},t}(),b=function(e){function n(t){var n=e.call(this)||this;return n._token=t,n}return(0,t.__extends)(n,e),Object.defineProperty(n.prototype,"token",{get:function(){return this._token},set:function(e){this._token=e},enumerable:!0,configurable:!0}),n.prototype.fetch=function(t,n){void 0===n&&(n={});var r=new Headers;return x(r,n.headers),r.set("Authorization","Bearer "+this._token),n.headers=r,e.prototype.fetch.call(this,t,n)},n}(v),m=function(e){function r(t,n,r){var o=e.call(this,null)||this;return o.clientId=t,o.tenant=n,o.redirectUri=r,o}return(0,t.__extends)(r,e),r.fromSPFxContext=function(e,t){return void 0===t&&(t="c58637bb-e2e1-4312-8a00-04b5ffcd3403"),new r(t,e.pageContext.aadInfo.tenantId.toString(),a(window.location.origin,"/_forms/spfxsinglesignon.aspx"))},r.prototype.fetch=function(t,n){var r=this;if(!h(t))throw new Error("You must supply absolute urls to AdalClient.fetch.");return this.getToken(this.getResource(t)).then(function(o){return r.token=o,e.prototype.fetch.call(r,t,n)})},r.prototype.getToken=function(e){var t=this;return new Promise(function(n,o){t.ensureAuthContext().then(function(e){return t.login()}).then(function(t){r._authContext.acquireToken(e,function(e,t){if(e)return o(new Error(e));n(t)})}).catch(o)})},r.prototype.ensureAuthContext=function(){var e=this;return new Promise(function(t){null===r._authContext&&(r._authContext=(0,n.inject)({clientId:e.clientId,displayCall:function(t){e._displayCallback&&e._displayCallback(t)},navigateToLoginRequestUrl:!1,redirectUri:e.redirectUri,tenant:e.tenant})),t()})},r.prototype.login=function(){var e=this;return this._loginPromise?this._loginPromise:(this._loginPromise=new Promise(function(t,n){if(r._authContext.getCachedUser())return t();e._displayCallback=function(o){var i=window.open(o,"login","width=483, height=600");if(!i)return n(new Error("Could not open pop-up window for auth. Likely pop-ups are blocked by the browser."));i&&i.focus&&i.focus();var a=window.setInterval(function(){i&&!i.closed&&void 0!==i.closed||window.clearInterval(a);try{-1!==i.document.URL.indexOf(e.redirectUri)&&(window.clearInterval(a),r._authContext.handleWindowCallback(i.location.hash),i.close(),t())}catch(e){n(e)}},30)},e.ensureAuthContext().then(function(t){r._authContext._loginInProgress=!1,r._authContext.login(),e._displayCallback=null})}),this._loginPromise)},r.prototype.getResource=function(e){var t=document.createElement("a");return t.href=e,t.protocol+"//"+t.hostname},r._authContext=null,r}(b);function C(e){return _(e,"string")}function w(e){return _(e,"buffer")}function _(e,t){return new Promise(function(n,r){try{var o=new FileReader;switch(o.onload=function(e){n(e.target.result)},t){case"string":o.readAsText(e);break;case"buffer":o.readAsArrayBuffer(e)}}catch(e){r(e)}})}var k=function(){function e(e,t){void 0===e&&(e=[]),void 0===t&&(t=[]),this.keys=e,this.values=t}return e.prototype.get=function(e){var t=this.keys.indexOf(e);return t<0?null:this.values[t]},e.prototype.add=function(e,t){var n=this.keys.indexOf(e);n>-1?null===t?this.remove(e):this.values[n]=t:null!==t&&(this.keys.push(e),this.values.push(t))},e.prototype.merge=function(e){var t=this;if("getKeys"in e){var n=e;n.getKeys().map(function(e){t.add(e,n.get(e))})}else{var r=e;for(var o in r)r.hasOwnProperty(o)&&this.add(o,r[o])}},e.prototype.remove=function(e){var t=this.keys.indexOf(e);if(t<0)return null;var n=this.values[t];return this.keys.splice(t,1),this.values.splice(t,1),n},e.prototype.getKeys=function(){return this.keys},e.prototype.getValues=function(){return this.values},e.prototype.clear=function(){this.keys=[],this.values=[]},Object.defineProperty(e.prototype,"count",{get:function(){return this.keys.length},enumerable:!0,configurable:!0}),e}();function P(e,t){return function(n,o,i){var a=i.value;i.value=function(){for(var s=[],u=0;u<arguments.length;u++)s[u]=arguments[u];return r.Logger.log({data:{descriptor:i,propertyKey:o,target:n},level:2,message:"("+e+") "+t}),a.apply(this,s)}}}function A(e){return void 0===e&&(e="This feature is flagged as beta and is subject to change."),function(t,n,o){var i=o.value;o.value=function(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];return r.Logger.log({data:{descriptor:o,propertyKey:n,target:t},level:2,message:e}),i.apply(this,a)}}}var I=function(e){function n(t){var n=e.call(this,t)||this;return n.name="UrlException",r.Logger.log({data:{},level:3,message:"["+n.name+"]::"+n.message}),n}return(0,t.__extends)(n,e),n}(Error);function E(e){S.extend(e)}var O=function(){function e(){this._v=new k,this._v.add("defaultCachingStore","session"),this._v.add("defaultCachingTimeoutSeconds",60),this._v.add("globalCacheDisable",!1),this._v.add("enableCacheExpiration",!1),this._v.add("cacheExpirationIntervalMilliseconds",750),this._v.add("spfxContext",null)}return e.prototype.extend=function(e){var t=this;Object.keys(e).forEach(function(n){t._v.add(n,e[n])})},e.prototype.get=function(e){return this._v.get(e)},Object.defineProperty(e.prototype,"defaultCachingStore",{get:function(){return this.get("defaultCachingStore")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"defaultCachingTimeoutSeconds",{get:function(){return this.get("defaultCachingTimeoutSeconds")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"globalCacheDisable",{get:function(){return this.get("globalCacheDisable")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableCacheExpiration",{get:function(){return this.get("enableCacheExpiration")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cacheExpirationIntervalMilliseconds",{get:function(){return this.get("cacheExpirationIntervalMilliseconds")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spfxContext",{get:function(){return this.get("spfxContext")},enumerable:!0,configurable:!0}),e}(),T=new O,S=T,j=function(){function e(e,t){void 0===t&&(t=-1),this.store=e,this.defaultTimeoutMinutes=t,this.enabled=this.test(),S.enableCacheExpiration&&(r.Logger.write("Enabling cache expiration.",1),this.cacheExpirationHandler())}return e.prototype.get=function(e){if(!this.enabled)return null;var t=this.store.getItem(e);if(null==t)return null;var n=JSON.parse(t);return new Date(n.expiration)<=new Date?(r.Logger.write("Removing item with key '"+e+"' from cache due to expiration.",1),this.delete(e),null):n.value},e.prototype.put=function(e,t,n){this.enabled&&this.store.setItem(e,this.createPersistable(t,n))},e.prototype.delete=function(e){this.enabled&&this.store.removeItem(e)},e.prototype.getOrPut=function(e,t,n){var r=this;return this.enabled?new Promise(function(o){var i=r.get(e);null==i?t().then(function(t){r.put(e,t,n),o(t)}):o(i)}):t()},e.prototype.deleteExpired=function(){var e=this;return new Promise(function(t,n){e.enabled||t();try{for(var r=0;r<e.store.length;r++){var o=e.store.key(r);null!==o&&/["|']?pnp["|']? ?: ?1/i.test(e.store.getItem(o))&&e.get(o)}t()}catch(e){n(e)}})},e.prototype.test=function(){try{return this.store.setItem("test","test"),this.store.removeItem("test"),!0}catch(e){return!1}},e.prototype.createPersistable=function(e,t){if(void 0===t){var n=S.defaultCachingTimeoutSeconds;this.defaultTimeoutMinutes>0&&(n=60*this.defaultTimeoutMinutes),t=i(new Date,"second",n)}return JSON.stringify({pnp:1,expiration:t,value:e})},e.prototype.cacheExpirationHandler=function(){var e=this;r.Logger.write("Called cache expiration handler.",0),this.deleteExpired().then(function(t){setTimeout(o(e,e.cacheExpirationHandler),S.cacheExpirationIntervalMilliseconds)}).catch(function(e){r.Logger.log({data:e,level:3,message:"Error deleting expired cache entries, see data for details. Timeout not reset."})})},e}(),D=function(){function e(e){void 0===e&&(e=new k),this._store=e}return Object.defineProperty(e.prototype,"length",{get:function(){return this._store.count},enumerable:!0,configurable:!0}),e.prototype.clear=function(){this._store.clear()},e.prototype.getItem=function(e){return this._store.get(e)},e.prototype.key=function(e){return this._store.getKeys()[e]},e.prototype.removeItem=function(e){this._store.remove(e)},e.prototype.setItem=function(e,t){this._store.add(e,t)},e}(),U=function(){function e(e,t){void 0===e&&(e=null),void 0===t&&(t=null),this._local=e,this._session=t}return Object.defineProperty(e.prototype,"local",{get:function(){return null===this._local&&(this._local="undefined"!=typeof localStorage?new j(localStorage):new j(new D)),this._local},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"session",{get:function(){return null===this._session&&(this._session="undefined"!=typeof sessionStorage?new j(sessionStorage):new j(new D)),this._session},enumerable:!0,configurable:!0}),e}();exports.AdalClient=m,exports.readBlobAsText=C,exports.readBlobAsArrayBuffer=w,exports.Dictionary=k,exports.deprecated=P,exports.beta=A,exports.UrlException=I,exports.setup=E,exports.RuntimeConfigImpl=O,exports.RuntimeConfig=S,exports.mergeHeaders=x,exports.mergeOptions=y,exports.FetchClient=v,exports.BearerTokenFetchClient=b,exports.PnPClientStorageWrapper=j,exports.PnPClientStorage=U,exports.getCtxCallback=o,exports.dateAdd=i,exports.combinePaths=a,exports.getRandomString=s,exports.getGUID=u,exports.isFunc=l,exports.objectDefinedNotNull=c,exports.isArray=p,exports.extend=f,exports.isUrlAbsolute=h,exports.stringIsNullOrEmpty=d,exports.Util=g;
},{"tslib":8,"adal-angular":14,"@pnp/logging":6}],9:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ODataBatch=exports.ODataQueryable=exports.Queryable=exports.AlreadyInBatchException=exports.getDefaultPipeline=exports.PipelineMethods=exports.requestPipelineMethod=exports.pipe=exports.setResult=exports.BufferParser=exports.JSONParser=exports.BlobParser=exports.TextParser=exports.ODataDefaultParser=exports.ODataParserBase=exports.ProcessHttpClientResponseException=exports.CachingParserWrapper=exports.CachingOptions=void 0;var e=require("@pnp/common"),t=require("tslib"),r=require("@pnp/logging"),n=function(){function t(t){this.key=t,this.expiration=(0,e.dateAdd)(new Date,"second",e.RuntimeConfig.defaultCachingTimeoutSeconds),this.storeName=e.RuntimeConfig.defaultCachingStore}return Object.defineProperty(t.prototype,"store",{get:function(){return"local"===this.storeName?t.storage.local:t.storage.session},enumerable:!0,configurable:!0}),t.storage=new e.PnPClientStorage,t}(),o=function(){function e(e,t){this._parser=e,this._cacheOptions=t}return e.prototype.parse=function(e){var t=this;return this._parser.parse(e).then(function(e){return null!==t._cacheOptions.store&&t._cacheOptions.store.put(t._cacheOptions.key,e,t._cacheOptions.expiration),e})},e}(),i=function(e){function n(t,n,o){var i=e.call(this,"Error making HttpClient request in queryable: ["+t+"] "+n)||this;return i.status=t,i.statusText=n,i.data=o,i.name="ProcessHttpClientResponseException",r.Logger.log({data:i.data,level:3,message:i.message}),i}return(0,t.__extends)(n,e),n}(Error),s=function(){function e(){}return e.prototype.parse=function(e){var t=this;return new Promise(function(r,n){t.handleError(e,n)&&e.text().then(function(e){return e.replace(/\s/gi,"").length>0?JSON.parse(e):{}}).then(function(e){return r(t.parseODataJSON(e))}).catch(function(e){return n(e)})})},e.prototype.handleError=function(e,t){return e.ok||e.json().then(function(r){var n={responseBody:r,responseHeaders:e.headers};t(new i(e.status,e.statusText,n))}).catch(function(n){r.Logger.log({data:n,level:2,message:"There was an error parsing the error response body. See data for details."});var o={responseBody:"[[body not available]]",responseHeaders:e.headers};t(new i(e.status,e.statusText,o))}),e.ok},e.prototype.parseODataJSON=function(e){var t=e;return e.hasOwnProperty("d")?t=e.d.hasOwnProperty("results")?e.d.results:e.d:e.hasOwnProperty("value")&&(t=e.value),t},e}(),u=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return(0,t.__extends)(r,e),r}(s),a=function(){function e(){}return e.prototype.parse=function(e){return e.text()},e}(),c=function(){function e(){}return e.prototype.parse=function(e){return e.blob()},e}(),p=function(){function e(){}return e.prototype.parse=function(e){return e.json()},e}(),l=function(){function t(){}return t.prototype.parse=function(t){return(0,e.isFunc)(t.arrayBuffer)?t.arrayBuffer():t.buffer()},t}();function h(e){return r.Logger.log({data:e.result,level:0,message:"["+e.requestId+"] ("+(new Date).getTime()+") Returning result, see data property for value."}),Promise.resolve(e.result||null)}function f(e,t){return new Promise(function(r){e.result=t,e.hasResult=!0,r(e)})}function d(e){return e.pipeline.length>0?e.pipeline.shift()(e):Promise.resolve(e)}function g(e){return e.pipeline.length<1&&r.Logger.write("["+e.requestId+"] ("+(new Date).getTime()+") Request pipeline contains no methods!",2),d(e).then(function(e){return h(e)}).catch(function(e){throw r.Logger.error(e),e})}function y(e){return void 0===e&&(e=!1),function(t,n,o){var i=o.value;o.value=function(){for(var o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];return!e&&o.length>0&&o[0].hasOwnProperty("hasResult")&&o[0].hasResult?(r.Logger.write("["+o[0].requestId+"] ("+(new Date).getTime()+") Skipping request pipeline method "+n+", existing result in pipeline.",0),Promise.resolve(o[0])):(r.Logger.write("["+o[0].requestId+"] ("+(new Date).getTime()+") Calling request pipeline method "+n+".",0),i.apply(t,o).then(function(e){return d(e)}))}}}var v=function(){function i(){}return i.logStart=function(e){return new Promise(function(t){r.Logger.log({data:1===r.Logger.activeLogLevel?{}:e,level:1,message:"["+e.requestId+"] ("+(new Date).getTime()+") Beginning "+e.verb+" request ("+e.requestAbsoluteUrl+")"}),t(e)})},i.caching=function(t){return new Promise(function(i){if("GET"===t.verb&&t.isCached){r.Logger.write("["+t.requestId+"] ("+(new Date).getTime()+") Caching is enabled for request, checking cache...",1);var s=new n(t.requestAbsoluteUrl.toLowerCase());if(void 0!==t.cachingOptions&&(s=(0,e.extend)(s,t.cachingOptions)),null!==s.store){var u=s.store.get(s.key);if(null!==u)return r.Logger.log({data:1===r.Logger.activeLogLevel?{}:u,level:1,message:"["+t.requestId+"] ("+(new Date).getTime()+") Value returned from cache."}),(0,e.isFunc)(t.batchDependency)&&t.batchDependency(),t.parser.hasOwnProperty("hydrate")&&(u=t.parser.hydrate(u)),f(t,u).then(function(e){return i(e)})}r.Logger.write("["+t.requestId+"] ("+(new Date).getTime()+") Value not found in cache.",1),t.parser=new o(t.parser,s)}return i(t)})},i.send=function(t){return new Promise(function(n,o){if(t.isBatched){var i=t.batch.add(t.requestAbsoluteUrl,t.verb,t.options,t.parser);(0,e.isFunc)(t.batchDependency)&&t.batchDependency(),r.Logger.write("["+t.requestId+"] ("+(new Date).getTime()+") Batching request in batch "+t.batch.batchId+".",1),n(f(t,i))}else{r.Logger.write("["+t.requestId+"] ("+(new Date).getTime()+") Sending request.",1);var s=t.clientFactory(),u=(0,e.extend)(t.options||{},{method:t.verb});s.fetch(t.requestAbsoluteUrl,u).then(function(e){return t.parser.parse(e)}).then(function(e){return f(t,e)}).then(function(e){return n(e)}).catch(function(e){return o(e)})}})},i.logEnd=function(e){return new Promise(function(t){e.isBatched?r.Logger.log({data:1===r.Logger.activeLogLevel?{}:e,level:1,message:"["+e.requestId+"] ("+(new Date).getTime()+") "+e.verb+" request will complete in batch "+e.batch.batchId+"."}):r.Logger.log({data:1===r.Logger.activeLogLevel?{}:e,level:1,message:"["+e.requestId+"] ("+(new Date).getTime()+") Completing "+e.verb+" request."}),t(e)})},(0,t.__decorate)([y(!0)],i,"logStart",null),(0,t.__decorate)([y()],i,"caching",null),(0,t.__decorate)([y()],i,"send",null),(0,t.__decorate)([y(!0)],i,"logEnd",null),i}();function b(){return[v.logStart,v.caching,v.send,v.logEnd].slice(0)}var x=function(e){function n(t){void 0===t&&(t="This query is already part of a batch.");var n=e.call(this,t)||this;return n.name="AlreadyInBatchException",r.Logger.error(n),n}return(0,t.__extends)(n,e),n}(Error),m=function(){function t(){this._query=new e.Dictionary,this._options={},this._url="",this._parentUrl="",this._useCaching=!1,this._cachingOptions=null}return t.prototype.toUrl=function(){return this._url},t.prototype.concat=function(e){return this._url+=e,this},Object.defineProperty(t.prototype,"query",{get:function(){return this._query},enumerable:!0,configurable:!0}),t.prototype.configure=function(t){return(0,e.mergeOptions)(this._options,t),this},t.prototype.configureFrom=function(t){return(0,e.mergeOptions)(this._options,t._options),this},t.prototype.usingCaching=function(t){return e.RuntimeConfig.globalCacheDisable||(this._useCaching=!0,void 0!==t&&(this._cachingOptions=t)),this},t.prototype.get=function(e,t){return void 0===e&&(e=new p),void 0===t&&(t={}),this.getCore(e,t)},t.prototype.getCore=function(e,t){return void 0===e&&(e=new p),void 0===t&&(t={}),this.toRequestContext("GET",t,e,b()).then(function(e){return g(e)})},t.prototype.postCore=function(e,t){return void 0===e&&(e={}),void 0===t&&(t=new p),this.toRequestContext("POST",e,t,b()).then(function(e){return g(e)})},t.prototype.patchCore=function(e,t){return void 0===e&&(e={}),void 0===t&&(t=new p),this.toRequestContext("PATCH",e,t,b()).then(function(e){return g(e)})},t.prototype.deleteCore=function(e,t){return void 0===e&&(e={}),void 0===t&&(t=new p),this.toRequestContext("DELETE",e,t,b()).then(function(e){return g(e)})},t.prototype.putCore=function(e,t){return void 0===e&&(e={}),void 0===t&&(t=new p),this.toRequestContext("PUT",e,t,b()).then(function(e){return g(e)})},t.prototype.append=function(t){this._url=(0,e.combinePaths)(this._url,t)},Object.defineProperty(t.prototype,"parentUrl",{get:function(){return this._parentUrl},enumerable:!0,configurable:!0}),t.prototype.extend=function(t,r){this._parentUrl=t._url,this._url=(0,e.combinePaths)(this._parentUrl,r),this.configureFrom(t)},t}(),_=function(r){function n(){var e=r.call(this)||this;return e._batch=null,e}return(0,t.__extends)(n,r),n.prototype.inBatch=function(e){if(null!==this.batch)throw new x;return this._batch=e,this},n.prototype.toUrl=function(){return this._url},n.prototype.get=function(e,t){return void 0===e&&(e=new u),void 0===t&&(t={}),this.getCore(e,t)},n.prototype.getCore=function(e,t){return void 0===e&&(e=new u),void 0===t&&(t={}),this.toRequestContext("GET",t,e,b()).then(function(e){return g(e)})},n.prototype.postCore=function(e,t){return void 0===e&&(e={}),void 0===t&&(t=new u),this.toRequestContext("POST",e,t,b()).then(function(e){return g(e)})},n.prototype.patchCore=function(e,t){return void 0===e&&(e={}),void 0===t&&(t=new u),this.toRequestContext("PATCH",e,t,b()).then(function(e){return g(e)})},n.prototype.deleteCore=function(e,t){return void 0===e&&(e={}),void 0===t&&(t=new u),this.toRequestContext("DELETE",e,t,b()).then(function(e){return g(e)})},n.prototype.putCore=function(e,t){return void 0===e&&(e={}),void 0===t&&(t=new u),this.toRequestContext("PUT",e,t,b()).then(function(e){return g(e)})},n.prototype.addBatchDependency=function(){return null!==this._batch?this._batch.addDependency():function(){return null}},Object.defineProperty(n.prototype,"hasBatch",{get:function(){return(0,e.objectDefinedNotNull)(this._batch)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"batch",{get:function(){return this.hasBatch?this._batch:null},enumerable:!0,configurable:!0}),n}(m),P=function(){function t(t){void 0===t&&(t=(0,e.getGUID)()),this._batchId=t,this._requests=[],this._dependencies=[]}return Object.defineProperty(t.prototype,"batchId",{get:function(){return this._batchId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"requests",{get:function(){return this._requests},enumerable:!0,configurable:!0}),t.prototype.add=function(e,t,r,n){var o={method:t.toUpperCase(),options:r,parser:n,reject:null,resolve:null,url:e},i=new Promise(function(e,t){o.resolve=e,o.reject=t});return this._requests.push(o),i},t.prototype.addDependency=function(){var e=function(){},t=new Promise(function(t){e=t});return this._dependencies.push(t),e},t.prototype.execute=function(){var e=this;return Promise.all(this._dependencies).then(function(){return Promise.all(e._dependencies)}).then(function(){return e.executeImpl()})},t}();exports.CachingOptions=n,exports.CachingParserWrapper=o,exports.ProcessHttpClientResponseException=i,exports.ODataParserBase=s,exports.ODataDefaultParser=u,exports.TextParser=a,exports.BlobParser=c,exports.JSONParser=p,exports.BufferParser=l,exports.setResult=f,exports.pipe=g,exports.requestPipelineMethod=y,exports.PipelineMethods=v,exports.getDefaultPipeline=b,exports.AlreadyInBatchException=x,exports.Queryable=m,exports.ODataQueryable=_,exports.ODataBatch=P;
},{"@pnp/common":7,"tslib":8,"@pnp/logging":6}],4:[function(require,module,exports) {
var global = (1,eval)("this");
var e=(0,eval)("this");Object.defineProperty(exports,"__esModule",{value:!0}),exports.ChoiceFieldFormatType=exports.FieldUserSelectionMode=exports.RenderListDataOptions=exports.SharingDomainRestrictionMode=exports.SPSharedObjectType=exports.SharingOperationStatusCode=exports.SharingRole=exports.SharingLinkKind=exports.PageType=exports.RoleType=exports.PermissionKind=exports.UrlFieldFormatType=exports.CalendarType=exports.AddFieldOptions=exports.DateTimeFieldFormatType=exports.FieldTypes=exports.ControlMode=exports.MySocialQuery=exports.SocialQuery=exports.ClientSideWebpart=exports.ClientSideText=exports.ClientSidePart=exports.CanvasColumn=exports.CanvasControl=exports.CanvasSection=exports.ClientSidePage=exports.Web=exports.WebPart=exports.WebPartDefinition=exports.WebPartDefinitions=exports.UtilityMethod=exports.Site=exports.SearchSuggestResult=exports.SearchSuggest=exports.SearchBuiltInSourceId=exports.QueryPropertyValueType=exports.ReorderingRuleMatchType=exports.SortDirection=exports.SearchResults=exports.SearchQueryBuilder=exports.Search=exports.RoleDefinitionBindings=exports.SPRest=exports.sp=exports.TimeZones=exports.TimeZone=exports.InstalledLanguages=exports.RegionalSettings=exports.Lists=exports.List=exports.NavigationService=exports.NavigationNode=exports.NavigationNodes=exports.PagedItemCollection=exports.ItemVersions=exports.ItemVersion=exports.Items=exports.Item=exports.SPHttpClient=exports.Folders=exports.Folder=exports.Files=exports.File=exports.TemplateFileType=exports.MoveOperations=exports.WebPartsPersonalizationScope=exports.CheckinType=exports.Fields=exports.Field=exports.FieldLinks=exports.FieldLink=exports.ContentTypes=exports.ContentType=exports.App=exports.AppCatalog=exports.SharePointQueryableShareableWeb=exports.SharePointQueryableShareableItem=exports.SharePointQueryableShareableFolder=exports.SharePointQueryableShareableFile=exports.SharePointQueryableShareable=exports.FileFolderShared=exports.SharePointQueryableSecurable=exports.SharePointQueryableCollection=exports.SharePointQueryableInstance=exports.SharePointQueryable=exports.spODataEntityArray=exports.spODataEntity=exports.spExtractODataId=void 0;var t=require("tslib"),r=require("@pnp/logging"),n=require("@pnp/common"),o=require("@pnp/odata");function i(e){if(null===e)return"";var t=e.indexOf("_api/");return t>-1?e.substr(0,t):e}var s=function(e){function n(t){var n=e.call(this,t)||this;return n.name="BatchParseException",r.Logger.error(n),n}return(0,t.__extends)(n,e),n}(Error),a=function(e){function n(t,n){void 0===n&&(n="Could not extract odata id in object, you may be using nometadata. Object data logged to logger.");var o=e.call(this,n)||this;return o.data=t,o.name="ODataIdException",r.Logger.error(o),o}return(0,t.__extends)(n,e),n}(Error),u=function(e){function n(t){void 0===t&&(t="The maximum comment length is 1023 characters.");var n=e.call(this,t)||this;return n.name="MaxCommentLengthException",r.Logger.error(n),n}return(0,t.__extends)(n,e),n}(Error),p=function(e){function n(t){void 0===t&&(t="This operation");var n=e.call(this,t+" is not supported as part of a batch.")||this;return n.name="NotSupportedInBatchException",r.Logger.error(n),n}return(0,t.__extends)(n,e),n}(Error),l=function(e){function n(t){void 0===t&&(t="Unable to determine API url.");var n=e.call(this,t)||this;return n.name="APIUrlException",r.Logger.error(n),n}return(0,t.__extends)(n,e),n}(Error);function c(e){if(e.hasOwnProperty("odata.id"))return e["odata.id"];if(e.hasOwnProperty("__metadata")&&e.__metadata.hasOwnProperty("id"))return e.__metadata.id;throw new a(e)}var d=function(e){function r(t){var r=e.call(this)||this;return r.factory=t,r.hydrate=function(e){var t=new r.factory(f(e),null);return(0,n.extend)(t,e)},r}return(0,t.__extends)(r,e),r.prototype.parse=function(t){var r=this;return e.prototype.parse.call(this,t).then(function(e){var t=new r.factory(f(e),null);return(0,n.extend)(t,e)})},r}(o.ODataParserBase),h=function(e){function r(t){var r=e.call(this)||this;return r.factory=t,r.hydrate=function(e){return e.map(function(e){var t=new r.factory(f(e),null);return(0,n.extend)(t,e)})},r}return(0,t.__extends)(r,e),r.prototype.parse=function(t){var r=this;return e.prototype.parse.call(this,t).then(function(e){return e.map(function(e){var t=new r.factory(f(e),null);return(0,n.extend)(t,e)})})},r}(o.ODataParserBase);function f(e){return e.hasOwnProperty("odata.metadata")&&e.hasOwnProperty("odata.editLink")?(0,n.combinePaths)(i(e["odata.metadata"]),"_api",e["odata.editLink"]):e.hasOwnProperty("__metadata")?e.__metadata.uri:(r.Logger.write("No uri information found in ODataEntity parsing, chaining will fail for this object.",2),"")}function y(e){return new d(e)}function g(e){return new h(e)}function m(e){n.RuntimeConfig.extend(e)}var b=function(){function e(){}return Object.defineProperty(e.prototype,"headers",{get:function(){var e=n.RuntimeConfig.get("sp");return null!==e&&void 0!==e&&void 0!==e.headers?e.headers:{}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"baseUrl",{get:function(){var e=n.RuntimeConfig.get("sp");return null!==e&&void 0!==e.baseUrl?e.baseUrl:null!==n.RuntimeConfig.spfxContext?n.RuntimeConfig.spfxContext.pageContext.web.absoluteUrl:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fetchClientFactory",{get:function(){var e=n.RuntimeConfig.get("sp");return null!==e&&void 0!==e.fetchClientFactory?e.fetchClientFactory:function(){return new n.FetchClient}},enumerable:!0,configurable:!0}),e}(),v=new b,P=function(){return function(){}}(),x=new n.Dictionary,w=function(){function e(e,t){void 0===t&&(t=x),this._httpClient=e,this._digests=t}return e.prototype.getDigest=function(e){var t=this,r=this._digests.get(e);if(null!==r&&new Date<r.expiration)return Promise.resolve(r.value);var i=(0,n.combinePaths)(e,"/_api/contextinfo");return this._httpClient.fetchRaw(i,{cache:"no-cache",credentials:"same-origin",headers:(0,n.extend)({Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose;charset=utf-8"},v.headers,!0),method:"POST"}).then(function(e){return(new o.ODataDefaultParser).parse(e).then(function(e){return e.GetContextWebInformation})}).then(function(r){var n=new P;n.value=r.FormDigestValue;var o=r.FormDigestTimeoutSeconds,i=new Date;return i.setTime(i.getTime()+1e3*o),n.expiration=i,t._digests.add(e,n),n.value})},e.prototype.clear=function(){this._digests.clear()},e}(),S=function(){function e(){this._impl=v.fetchClientFactory(),this._digestCache=new w(this)}return e.prototype.fetch=function(e,t){var r=this;void 0===t&&(t={});var o=(0,n.extend)(t,{cache:"no-cache",credentials:"same-origin"},!0),i=new Headers;if((0,n.mergeHeaders)(i,v.headers),(0,n.mergeHeaders)(i,t.headers),i.has("Accept")||i.append("Accept","application/json"),i.has("Content-Type")||i.append("Content-Type","application/json;odata=verbose;charset=utf-8"),i.has("X-ClientService-ClientTag")||i.append("X-ClientService-ClientTag","PnPCoreJS:@pnp-$$Version$$"),i.has("User-Agent")||i.append("User-Agent","NONISV|SharePointPnP|PnPCoreJS/$$Version$$"),(o=(0,n.extend)(o,{headers:i})).method&&"GET"!==o.method.toUpperCase()&&!i.has("X-RequestDigest")&&!i.has("Authorization")){var s=e.indexOf("_api/");if(s<0)throw new l;var a=e.substr(0,s);return this._digestCache.getDigest(a).then(function(t){return i.append("X-RequestDigest",t),r.fetchRaw(e,o)})}return this.fetchRaw(e,o)},e.prototype.fetchRaw=function(e,t){var r=this;void 0===t&&(t={});var o=new Headers;(0,n.mergeHeaders)(o,t.headers),t=(0,n.extend)(t,{headers:o});var i=function(o){r._impl.fetch(e,t).then(function(e){return o.resolve(e)}).catch(function(e){429!==e.status&&503!==e.status&&o.reject(e);var t=o.delay;o.delay*=2,o.attempts++,o.retryCount<=o.attempts&&o.reject(e),setTimeout((0,n.getCtxCallback)(r,i,o),t)})};return new Promise(function(e,t){var n={attempts:0,delay:100,reject:t,resolve:e,retryCount:7};i.call(r,n)})},e.prototype.get=function(e,t){void 0===t&&(t={});var r=(0,n.extend)(t,{method:"GET"});return this.fetch(e,r)},e.prototype.post=function(e,t){void 0===t&&(t={});var r=(0,n.extend)(t,{method:"POST"});return this.fetch(e,r)},e.prototype.patch=function(e,t){void 0===t&&(t={});var r=(0,n.extend)(t,{method:"PATCH"});return this.fetch(e,r)},e.prototype.delete=function(e,t){void 0===t&&(t={});var r=(0,n.extend)(t,{method:"DELETE"});return this.fetch(e,r)},e}();function C(t){return new Promise(function(r){if((0,n.isUrlAbsolute)(t))return r(t);if(null!==v.baseUrl)return r((0,n.combinePaths)(v.baseUrl,t));if(void 0!==e._spPageContextInfo){if(e._spPageContextInfo.hasOwnProperty("webAbsoluteUrl"))return r((0,n.combinePaths)(e._spPageContextInfo.webAbsoluteUrl,t));if(e._spPageContextInfo.hasOwnProperty("webServerRelativeUrl"))return r((0,n.combinePaths)(e._spPageContextInfo.webServerRelativeUrl,t))}if(void 0!==e.location){var o=e.location.toString().toLowerCase();["/_layouts/","/siteassets/"].forEach(function(e){var i=o.indexOf(e);if(i>0)return r((0,n.combinePaths)(o.substr(0,i),t))})}return r(t)})}var T,I=function(e){function o(t,r){var o=e.call(this)||this;if("string"==typeof t){var i=t;if((0,n.isUrlAbsolute)(i)||i.lastIndexOf("/")<0)o._parentUrl=i,o._url=(0,n.combinePaths)(i,r);else if(i.lastIndexOf("/")>i.lastIndexOf("(")){var s=i.lastIndexOf("/");o._parentUrl=i.slice(0,s),r=(0,n.combinePaths)(i.slice(s),r),o._url=(0,n.combinePaths)(o._parentUrl,r)}else{s=i.lastIndexOf("(");o._parentUrl=i.slice(0,s),o._url=(0,n.combinePaths)(i,r)}}else{var a=t;o.extend(a,r);var u=a._query.get("@target");null!==u&&o._query.add("@target",u)}return o}return(0,t.__extends)(o,e),o.prototype.as=function(e){var t=new e(this._url,null);return(0,n.extend)(t,this,!0)},o.prototype.toUrlAndQuery=function(){var e=new n.Dictionary,t=this.toUrl().replace(/'!(@.*?)::(.*?)'/gi,function(t,n,o){return r.Logger.write("Rewriting aliased parameter from match "+t+" to label: "+n+" value: "+o,0),e.add(n,"'"+o+"'"),n});return e.merge(this._query),e.count>0&&(t+="?"+e.getKeys().map(function(t){return t+"="+e.get(t)}).join("&")),t},o.prototype.getParent=function(e,t,r,n){void 0===t&&(t=this.parentUrl);var o=new e(t,r);o.configure(this._options);var i=this.query.get("@target");return null!==i&&o.query.add("@target",i),void 0!==n&&(o=o.inBatch(n)),o},o.prototype.clone=function(e,t,r){void 0===r&&(r=!0);var n=new e(this,t);n.configure(this._options);var o=this.query.get("@target");return null!==o&&n.query.add("@target",o),r&&this.hasBatch&&(n=n.inBatch(this.batch)),n},o.prototype.toRequestContext=function(e,t,r,o){var i=this;void 0===t&&(t={});var s=this.hasBatch?this.addBatchDependency():function(){};return C(this.toUrlAndQuery()).then(function(a){return(0,n.mergeOptions)(t,i._options),{batch:i.batch,batchDependency:s,cachingOptions:i._cachingOptions,clientFactory:function(){return new S},isBatched:i.hasBatch,isCached:i._useCaching,options:t,parser:r,pipeline:o,requestAbsoluteUrl:a,requestId:(0,n.getGUID)(),verb:e}})},o}(o.ODataQueryable),_=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return(0,t.__extends)(r,e),r.prototype.filter=function(e){return this._query.add("$filter",e),this},r.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this._query.add("$select",e.join(",")),this},r.prototype.expand=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this._query.add("$expand",e.join(",")),this},r.prototype.orderBy=function(e,t){var r=this;void 0===t&&(t=!0);var n=this._query.getKeys().filter(function(e){return"$orderby"===e}).map(function(e){return r._query.get(e)});return n.push(e+" "+(t?"asc":"desc")),this._query.add("$orderby",n.join(",")),this},r.prototype.skip=function(e){return this._query.add("$skip",e.toString()),this},r.prototype.top=function(e){return this._query.add("$top",e.toString()),this},r}(I),O=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return(0,t.__extends)(r,e),r.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this._query.add("$select",e.join(",")),this},r.prototype.expand=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this._query.add("$expand",e.join(",")),this},r}(I),F=function(e){function r(t,r){return void 0===r&&(r="siteusers"),e.call(this,t,r)||this}return(0,t.__extends)(r,e),r.prototype.getByEmail=function(e){return new D(this,"getByEmail('"+e+"')")},r.prototype.getById=function(e){return new D(this,"getById("+e+")")},r.prototype.getByLoginName=function(e){var t=new D(this);return t.concat("(@v)"),t.query.add("@v","'"+encodeURIComponent(e)+"'"),t},r.prototype.removeById=function(e){return this.clone(r,"removeById("+e+")").postCore()},r.prototype.removeByLoginName=function(e){var t=this.clone(r,"removeByLoginName(@v)");return t.query.add("@v","'"+encodeURIComponent(e)+"'"),t.postCore()},r.prototype.add=function(e){var t=this;return this.clone(r,null).postCore({body:JSON.stringify({__metadata:{type:"SP.User"},LoginName:e})}).then(function(){return t.getByLoginName(e)})},r}(_),D=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return(0,t.__extends)(r,e),Object.defineProperty(r.prototype,"groups",{get:function(){return new X(this,"groups")},enumerable:!0,configurable:!0}),r.prototype.update=function(e){var t=this,r=(0,n.extend)({__metadata:{type:"SP.User"}},e);return this.postCore({body:JSON.stringify(r),headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{data:e,user:t}})},r.prototype.delete=function(){return this.postCore({headers:{"X-HTTP-Method":"DELETE"}})},r}(O),R=function(e){function r(t,r){return void 0===r&&(r="currentuser"),e.call(this,t,r)||this}return(0,t.__extends)(r,e),r}(O);!function(e){e[e.None=0]="None",e[e.User=1]="User",e[e.DistributionList=2]="DistributionList",e[e.SecurityGroup=4]="SecurityGroup",e[e.SharePointGroup=8]="SharePointGroup",e[e.All=15]="All"}(T||(T={}));var L,U,B,E,N,j,A,k,M,q,Q,H,V,J,W,G,K,X=function(e){function r(t,r){return void 0===r&&(r="sitegroups"),e.call(this,t,r)||this}return(0,t.__extends)(r,e),r.prototype.add=function(e){var t=this,r=JSON.stringify((0,n.extend)({__metadata:{type:"SP.Group"}},e));return this.postCore({body:r}).then(function(e){return{data:e,group:t.getById(e.Id)}})},r.prototype.getByName=function(e){return new z(this,"getByName('"+e+"')")},r.prototype.getById=function(e){var t=new z(this);return t.concat("("+e+")"),t},r.prototype.removeById=function(e){return this.clone(r,"removeById('"+e+"')").postCore()},r.prototype.removeByLoginName=function(e){return this.clone(r,"removeByLoginName('"+e+"')").postCore()},r}(_),z=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return(0,t.__extends)(r,e),Object.defineProperty(r.prototype,"users",{get:function(){return new F(this,"users")},enumerable:!0,configurable:!0}),r.prototype.update=function(e){var t=this,o=(0,n.extend)({__metadata:{type:"SP.Group"}},e);return this.postCore({body:JSON.stringify(o),headers:{"X-HTTP-Method":"MERGE"}}).then(function(n){var o=t;return e.hasOwnProperty("Title")&&(o=t.getParent(r,t.parentUrl,"getByName('"+e.Title+"')")),{data:n,group:o}})},r}(O),$=function(e){function r(t,r){return void 0===r&&(r="roleassignments"),e.call(this,t,r)||this}return(0,t.__extends)(r,e),r.prototype.add=function(e,t){return this.clone(r,"addroleassignment(principalid="+e+", roledefid="+t+")").postCore()},r.prototype.remove=function(e,t){return this.clone(r,"removeroleassignment(principalid="+e+", roledefid="+t+")").postCore()},r.prototype.getById=function(e){var t=new Z(this);return t.concat("("+e+")"),t},r}(_),Z=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return(0,t.__extends)(r,e),Object.defineProperty(r.prototype,"groups",{get:function(){return new X(this,"groups")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"bindings",{get:function(){return new te(this)},enumerable:!0,configurable:!0}),r.prototype.delete=function(){return this.postCore({headers:{"X-HTTP-Method":"DELETE"}})},r}(O),Y=function(e){function r(t,r){return void 0===r&&(r="roledefinitions"),e.call(this,t,r)||this}return(0,t.__extends)(r,e),r.prototype.getById=function(e){return new ee(this,"getById("+e+")")},r.prototype.getByName=function(e){return new ee(this,"getbyname('"+e+"')")},r.prototype.getByType=function(e){return new ee(this,"getbytype("+e+")")},r.prototype.add=function(e,t,r,o){var i=this,s=JSON.stringify({BasePermissions:(0,n.extend)({__metadata:{type:"SP.BasePermissions"}},o),Description:t,Name:e,Order:r,__metadata:{type:"SP.RoleDefinition"}});return this.postCore({body:s}).then(function(e){return{data:e,definition:i.getById(e.Id)}})},r}(_),ee=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return(0,t.__extends)(r,e),r.prototype.update=function(e){var t=this;void 0!==e.hasOwnProperty("BasePermissions")&&(e.BasePermissions=(0,n.extend)({__metadata:{type:"SP.BasePermissions"}},e.BasePermissions));var r=JSON.stringify((0,n.extend)({__metadata:{type:"SP.RoleDefinition"}},e));return this.postCore({body:r,headers:{"X-HTTP-Method":"MERGE"}}).then(function(r){var n=t;e.hasOwnProperty("Name")&&(n=t.getParent(Y,t.parentUrl,"").getByName(e.Name));return{data:r,definition:n}})},r.prototype.delete=function(){return this.postCore({headers:{"X-HTTP-Method":"DELETE"}})},r}(O),te=function(e){function r(t,r){return void 0===r&&(r="roledefinitionbindings"),e.call(this,t,r)||this}return(0,t.__extends)(r,e),r}(_);!function(e){e[e.Display=1]="Display",e[e.Edit=2]="Edit",e[e.New=3]="New"}(L||(exports.ControlMode=L={})),function(e){e[e.Invalid=0]="Invalid",e[e.Integer=1]="Integer",e[e.Text=2]="Text",e[e.Note=3]="Note",e[e.DateTime=4]="DateTime",e[e.Counter=5]="Counter",e[e.Choice=6]="Choice",e[e.Lookup=7]="Lookup",e[e.Boolean=8]="Boolean",e[e.Number=9]="Number",e[e.Currency=10]="Currency",e[e.URL=11]="URL",e[e.Computed=12]="Computed",e[e.Threading=13]="Threading",e[e.Guid=14]="Guid",e[e.MultiChoice=15]="MultiChoice",e[e.GridChoice=16]="GridChoice",e[e.Calculated=17]="Calculated",e[e.File=18]="File",e[e.Attachments=19]="Attachments",e[e.User=20]="User",e[e.Recurrence=21]="Recurrence",e[e.CrossProjectLink=22]="CrossProjectLink",e[e.ModStat=23]="ModStat",e[e.Error=24]="Error",e[e.ContentTypeId=25]="ContentTypeId",e[e.PageSeparator=26]="PageSeparator",e[e.ThreadIndex=27]="ThreadIndex",e[e.WorkflowStatus=28]="WorkflowStatus",e[e.AllDayEvent=29]="AllDayEvent",e[e.WorkflowEventType=30]="WorkflowEventType"}(U||(exports.FieldTypes=U={})),function(e){e[e.DateOnly=0]="DateOnly",e[e.DateTime=1]="DateTime"}(B||(exports.DateTimeFieldFormatType=B={})),function(e){e[e.DefaultValue=0]="DefaultValue",e[e.AddToDefaultContentType=1]="AddToDefaultContentType",e[e.AddToNoContentType=2]="AddToNoContentType",e[e.AddToAllContentTypes=4]="AddToAllContentTypes",e[e.AddFieldInternalNameHint=8]="AddFieldInternalNameHint",e[e.AddFieldToDefaultView=16]="AddFieldToDefaultView",e[e.AddFieldCheckDisplayName=32]="AddFieldCheckDisplayName"}(E||(exports.AddFieldOptions=E={})),function(e){e[e.Gregorian=1]="Gregorian",e[e.Japan=3]="Japan",e[e.Taiwan=4]="Taiwan",e[e.Korea=5]="Korea",e[e.Hijri=6]="Hijri",e[e.Thai=7]="Thai",e[e.Hebrew=8]="Hebrew",e[e.GregorianMEFrench=9]="GregorianMEFrench",e[e.GregorianArabic=10]="GregorianArabic",e[e.GregorianXLITEnglish=11]="GregorianXLITEnglish",e[e.GregorianXLITFrench=12]="GregorianXLITFrench",e[e.KoreaJapanLunar=14]="KoreaJapanLunar",e[e.ChineseLunar=15]="ChineseLunar",e[e.SakaEra=16]="SakaEra",e[e.UmAlQura=23]="UmAlQura"}(N||(exports.CalendarType=N={})),function(e){e[e.Hyperlink=0]="Hyperlink",e[e.Image=1]="Image"}(j||(exports.UrlFieldFormatType=j={})),function(e){e[e.EmptyMask=0]="EmptyMask",e[e.ViewListItems=1]="ViewListItems",e[e.AddListItems=2]="AddListItems",e[e.EditListItems=3]="EditListItems",e[e.DeleteListItems=4]="DeleteListItems",e[e.ApproveItems=5]="ApproveItems",e[e.OpenItems=6]="OpenItems",e[e.ViewVersions=7]="ViewVersions",e[e.DeleteVersions=8]="DeleteVersions",e[e.CancelCheckout=9]="CancelCheckout",e[e.ManagePersonalViews=10]="ManagePersonalViews",e[e.ManageLists=12]="ManageLists",e[e.ViewFormPages=13]="ViewFormPages",e[e.AnonymousSearchAccessList=14]="AnonymousSearchAccessList",e[e.Open=17]="Open",e[e.ViewPages=18]="ViewPages",e[e.AddAndCustomizePages=19]="AddAndCustomizePages",e[e.ApplyThemeAndBorder=20]="ApplyThemeAndBorder",e[e.ApplyStyleSheets=21]="ApplyStyleSheets",e[e.ViewUsageData=22]="ViewUsageData",e[e.CreateSSCSite=23]="CreateSSCSite",e[e.ManageSubwebs=24]="ManageSubwebs",e[e.CreateGroups=25]="CreateGroups",e[e.ManagePermissions=26]="ManagePermissions",e[e.BrowseDirectories=27]="BrowseDirectories",e[e.BrowseUserInfo=28]="BrowseUserInfo",e[e.AddDelPrivateWebParts=29]="AddDelPrivateWebParts",e[e.UpdatePersonalWebParts=30]="UpdatePersonalWebParts",e[e.ManageWeb=31]="ManageWeb",e[e.AnonymousSearchAccessWebLists=32]="AnonymousSearchAccessWebLists",e[e.UseClientIntegration=37]="UseClientIntegration",e[e.UseRemoteAPIs=38]="UseRemoteAPIs",e[e.ManageAlerts=39]="ManageAlerts",e[e.CreateAlerts=40]="CreateAlerts",e[e.EditMyUserInfo=41]="EditMyUserInfo",e[e.EnumeratePermissions=63]="EnumeratePermissions",e[e.FullMask=65]="FullMask"}(A||(exports.PermissionKind=A={})),function(e){e[e.None=0]="None",e[e.Guest=1]="Guest",e[e.Reader=2]="Reader",e[e.Contributor=3]="Contributor",e[e.WebDesigner=4]="WebDesigner",e[e.Administrator=5]="Administrator"}(k||(exports.RoleType=k={})),function(e){e[e.Invalid=-1]="Invalid",e[e.DefaultView=0]="DefaultView",e[e.NormalView=1]="NormalView",e[e.DialogView=2]="DialogView",e[e.View=3]="View",e[e.DisplayForm=4]="DisplayForm",e[e.DisplayFormDialog=5]="DisplayFormDialog",e[e.EditForm=6]="EditForm",e[e.EditFormDialog=7]="EditFormDialog",e[e.NewForm=8]="NewForm",e[e.NewFormDialog=9]="NewFormDialog",e[e.SolutionForm=10]="SolutionForm",e[e.PAGE_MAXITEMS=11]="PAGE_MAXITEMS"}(M||(exports.PageType=M={})),function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Direct=1]="Direct",e[e.OrganizationView=2]="OrganizationView",e[e.OrganizationEdit=3]="OrganizationEdit",e[e.AnonymousView=4]="AnonymousView",e[e.AnonymousEdit=5]="AnonymousEdit",e[e.Flexible=6]="Flexible"}(q||(exports.SharingLinkKind=q={})),function(e){e[e.None=0]="None",e[e.View=1]="View",e[e.Edit=2]="Edit",e[e.Owner=3]="Owner"}(Q||(exports.SharingRole=Q={})),function(e){e[e.CompletedSuccessfully=0]="CompletedSuccessfully",e[e.AccessRequestsQueued=1]="AccessRequestsQueued",e[e.NoResolvedUsers=-1]="NoResolvedUsers",e[e.AccessDenied=-2]="AccessDenied",e[e.CrossSiteRequestNotSupported=-3]="CrossSiteRequestNotSupported",e[e.UnknowError=-4]="UnknowError",e[e.EmailBodyTooLong=-5]="EmailBodyTooLong",e[e.ListUniqueScopesExceeded=-6]="ListUniqueScopesExceeded",e[e.CapabilityDisabled=-7]="CapabilityDisabled",e[e.ObjectNotSupported=-8]="ObjectNotSupported",e[e.NestedGroupsNotSupported=-9]="NestedGroupsNotSupported"}(H||(exports.SharingOperationStatusCode=H={})),function(e){e[e.Unknown=0]="Unknown",e[e.File=1]="File",e[e.Folder=2]="Folder",e[e.Item=3]="Item",e[e.List=4]="List",e[e.Web=5]="Web",e[e.Max=6]="Max"}(V||(exports.SPSharedObjectType=V={})),function(e){e[e.None=0]="None",e[e.AllowList=1]="AllowList",e[e.BlockList=2]="BlockList"}(J||(exports.SharingDomainRestrictionMode=J={})),function(e){e[e.None=0]="None",e[e.ContextInfo=1]="ContextInfo",e[e.ListData=2]="ListData",e[e.ListSchema=4]="ListSchema",e[e.MenuView=8]="MenuView",e[e.ListContentType=16]="ListContentType",e[e.FileSystemItemId=32]="FileSystemItemId",e[e.ClientFormSchema=64]="ClientFormSchema",e[e.QuickLaunch=128]="QuickLaunch",e[e.Spotlight=256]="Spotlight",e[e.Visualization=512]="Visualization",e[e.ViewMetadata=1024]="ViewMetadata",e[e.DisableAutoHyperlink=2048]="DisableAutoHyperlink",e[e.EnableMediaTAUrls=4096]="EnableMediaTAUrls",e[e.ParentInfo=8192]="ParentInfo",e[e.PageContextInfo=16384]="PageContextInfo",e[e.ClientSideComponentManifest=32768]="ClientSideComponentManifest"}(W||(exports.RenderListDataOptions=W={})),function(e){e[e.PeopleAndGroups=1]="PeopleAndGroups",e[e.PeopleOnly=0]="PeopleOnly"}(G||(exports.FieldUserSelectionMode=G={})),function(e){e[e.Dropdown=0]="Dropdown",e[e.RadioButtons=1]="RadioButtons"}(K||(exports.ChoiceFieldFormatType=K={}));var re,ne,oe,ie,se=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return(0,t.__extends)(r,e),Object.defineProperty(r.prototype,"roleAssignments",{get:function(){return new $(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"firstUniqueAncestorSecurableObject",{get:function(){return new O(this,"FirstUniqueAncestorSecurableObject")},enumerable:!0,configurable:!0}),r.prototype.getUserEffectivePermissions=function(e){var t=this.clone(I,"getUserEffectivePermissions(@user)");return t.query.add("@user","'"+encodeURIComponent(e)+"'"),t.get().then(function(e){return e.hasOwnProperty("GetUserEffectivePermissions")?e.GetUserEffectivePermissions:e})},r.prototype.getCurrentUserEffectivePermissions=function(){var e=this;return new O("_api/web","currentuser").select("LoginName").get().then(function(t){return e.getUserEffectivePermissions(t.LoginName)})},r.prototype.breakRoleInheritance=function(e,t){return void 0===e&&(e=!1),void 0===t&&(t=!1),this.clone(r,"breakroleinheritance(copyroleassignments="+e+", clearsubscopes="+t+")").postCore()},r.prototype.resetRoleInheritance=function(){return this.clone(r,"resetroleinheritance").postCore()},r.prototype.userHasPermissions=function(e,t){var r=this;return this.getUserEffectivePermissions(e).then(function(e){return r.hasPermissions(e,t)})},r.prototype.currentUserHasPermissions=function(e){var t=this;return this.getCurrentUserEffectivePermissions().then(function(r){return t.hasPermissions(r,e)})},r.prototype.hasPermissions=function(e,t){if(!t)return!0;if(t===A.FullMask)return 32767==(32767&e.High)&&65535===e.Low;var r=1;return(t-=1)>=0&&t<32?(r<<=t,0!=(e.Low&r)):t>=32&&t<64&&(r<<=t-32,0!=(e.High&r))},r}(O),ae=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return(0,t.__extends)(r,e),r.prototype.getShareLink=function(e,t){void 0===t&&(t=null);var n=null!==t?t.toISOString():null;return this.clone(r,"shareLink").postCore({body:JSON.stringify({request:{createLink:!0,emailData:null,settings:{expiration:n,linkKind:e}}})})},r.prototype.shareWith=function(e,t,o,i,s){var a=this;void 0===o&&(o=!1),void 0===i&&(i=!1),Array.isArray(e)||(e=[e]);var u=JSON.stringify(e.map(function(e){return{Key:e}})),p=t===Q.Edit?k.Contributor:k.Reader;return new _("_api/web","roledefinitions").select("Id").filter("RoleTypeKind eq "+p).get().then(function(e){if(!Array.isArray(e)||e.length<1)throw new Error("Could not locate a role defintion with RoleTypeKind "+p);var t={includeAnonymousLinkInEmail:o,peoplePickerInput:u,propagateAcl:i,roleValue:"role:"+e[0].Id,useSimplifiedRoles:!0};return void 0!==s&&(t=(0,n.extend)(t,{emailBody:s.body,emailSubject:void 0!==s.subject?s.subject:"",sendEmail:!0})),a.clone(r,"shareObject").postCore({body:JSON.stringify(t)})})},r.prototype.shareObject=function(e,t){var r=this;return void 0===t&&(t=!1),t?this.sendShareObjectRequest(e):(e=(0,n.extend)(e,{group:null,includeAnonymousLinkInEmail:!1,propagateAcl:!1,useSimplifiedRoles:!0},!0),this.getRoleValue(e.role,e.group).then(function(t){Array.isArray(e.loginNames)||(e.loginNames=[e.loginNames]);var o={peoplePickerInput:JSON.stringify(e.loginNames.map(function(e){return{Key:e}})),roleValue:t,url:e.url};return void 0!==e.emailData&&null!==e.emailData&&(o=(0,n.extend)(o,{emailBody:e.emailData.body,emailSubject:void 0!==e.emailData.subject?e.emailData.subject:"Shared with you.",sendEmail:!0})),r.sendShareObjectRequest(o)}))},r.prototype.unshareObjectWeb=function(e){return this.clone(r,"unshareObject").postCore({body:JSON.stringify({url:e})})},r.prototype.checkPermissions=function(e){return this.clone(r,"checkPermissions").postCore({body:JSON.stringify({recipients:e})})},r.prototype.getSharingInformation=function(e){return void 0===e&&(e=null),this.clone(r,"getSharingInformation").postCore({body:JSON.stringify({request:e})})},r.prototype.getObjectSharingSettings=function(e){return void 0===e&&(e=!0),this.clone(r,"getObjectSharingSettings").postCore({body:JSON.stringify({useSimplifiedRoles:e})})},r.prototype.unshareObject=function(){return this.clone(r,"unshareObject").postCore()},r.prototype.deleteLinkByKind=function(e){return this.clone(r,"deleteLinkByKind").postCore({body:JSON.stringify({linkKind:e})})},r.prototype.unshareLink=function(e,t){return void 0===t&&(t="00000000-0000-0000-0000-000000000000"),this.clone(r,"unshareLink").postCore({body:JSON.stringify({linkKind:e,shareId:t})})},r.prototype.getRoleValue=function(e,t){if(void 0===t||null===t){var r=e===Q.Edit?k.Contributor:k.Reader;return new _("_api/web","roledefinitions").select("Id").top(1).filter("RoleTypeKind eq "+r).get().then(function(e){if(e.length<1)throw new Error("Could not locate associated role definition for supplied role. Edit and View are supported");return"role: "+e[0].Id})}switch(t){case k.Contributor:return new O("_api/web","associatedmembergroup").select("Id").get().then(function(e){return"group: "+e.Id});case k.Reader:case k.Guest:return new O("_api/web","associatedvisitorgroup").select("Id").get().then(function(e){return"group: "+e.Id});default:throw new Error("Could not determine role value for supplied value. Contributor, Reader, and Guest are supported")}},r.prototype.getShareObjectWeb=function(e){return Promise.resolve(new O(i(e),"/_api/SP.Web.ShareObject"))},r.prototype.sendShareObjectRequest=function(e){return this.getShareObjectWeb(this.toUrl()).then(function(t){return t.expand("UsersWithAccessRequests","GroupsSharedWith").as(r).postCore({body:JSON.stringify(e)})})},r}(I),ue=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return(0,t.__extends)(r,e),r.prototype.shareWith=function(e,t,r){var o=this;void 0===t&&(t=Q.View);var s=this.addBatchDependency();return new O(i(this.toUrl()),"/_api/web/url").get().then(function(i){return s(),o.shareObject((0,n.combinePaths)(i,"/_layouts/15/aclinv.aspx?forSharing=1&mbypass=1"),e,t,r)})},r.prototype.shareObject=function(e,t,r,n,o,i,s,a){return void 0===i&&(i=!1),void 0===s&&(s=!1),void 0===a&&(a=!0),this.clone(ae,null).shareObject({emailData:n,group:o,includeAnonymousLinkInEmail:s,loginNames:t,propagateAcl:i,role:r,url:e,useSimplifiedRoles:a})},r.prototype.shareObjectRaw=function(e){return this.clone(ae,null).shareObject(e,!0)},r.prototype.unshareObject=function(e){return this.clone(ae,null).unshareObjectWeb(e)},r}(se),pe=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return(0,t.__extends)(r,e),r.prototype.getShareLink=function(e,t){return void 0===e&&(e=q.OrganizationView),void 0===t&&(t=null),this.clone(ae,null).getShareLink(e,t)},r.prototype.shareWith=function(e,t,r,n){return void 0===t&&(t=Q.View),void 0===r&&(r=!1),this.clone(ae,null).shareWith(e,t,r,!1,n)},r.prototype.checkSharingPermissions=function(e){return this.clone(ae,null).checkPermissions(e)},r.prototype.getSharingInformation=function(e){return void 0===e&&(e=null),this.clone(ae,null).getSharingInformation(e)},r.prototype.getObjectSharingSettings=function(e){return void 0===e&&(e=!0),this.clone(ae,null).getObjectSharingSettings(e)},r.prototype.unshare=function(){return this.clone(ae,null).unshareObject()},r.prototype.deleteSharingLinkByKind=function(e){return this.clone(ae,null).deleteLinkByKind(e)},r.prototype.unshareLink=function(e,t){return this.clone(ae,null).unshareLink(e,t)},r}(se),le=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return(0,t.__extends)(r,e),r.prototype.getShareLink=function(e,t){void 0===e&&(e=q.OrganizationView),void 0===t&&(t=null);var r=this.addBatchDependency();return this.getShareable().then(function(n){return r(),n.getShareLink(e,t)})},r.prototype.checkSharingPermissions=function(e){var t=this.addBatchDependency();return this.getShareable().then(function(r){return t(),r.checkPermissions(e)})},r.prototype.getSharingInformation=function(e){void 0===e&&(e=null);var t=this.addBatchDependency();return this.getShareable().then(function(r){return t(),r.getSharingInformation(e)})},r.prototype.getObjectSharingSettings=function(e){void 0===e&&(e=!0);var t=this.addBatchDependency();return this.getShareable().then(function(r){return t(),r.getObjectSharingSettings(e)})},r.prototype.unshare=function(){var e=this.addBatchDependency();return this.getShareable().then(function(t){return e(),t.unshareObject()})},r.prototype.deleteSharingLinkByKind=function(e){var t=this.addBatchDependency();return this.getShareable().then(function(r){return t(),r.deleteLinkByKind(e)})},r.prototype.unshareLink=function(e,t){var r=this.addBatchDependency();return this.getShareable().then(function(n){return r(),n.unshareLink(e,t)})},r.prototype.getShareable=function(){var e=this;return this.clone(ce,"listItemAllFields",!1).select("odata.editlink").get().then(function(t){var r=new ae(f(t));return e.hasBatch&&(r=r.inBatch(e.batch)),r})},r}(O),ce=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return(0,t.__extends)(r,e),r.prototype.shareWith=function(e,t,r,n){void 0===t&&(t=Q.View),void 0===r&&(r=!1);var o=this.addBatchDependency();return this.getShareable().then(function(i){return o(),i.shareWith(e,t,r,!1,n)})},r}(le),de=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return(0,t.__extends)(r,e),r.prototype.shareWith=function(e,t,r,n,o){void 0===t&&(t=Q.View),void 0===r&&(r=!1),void 0===n&&(n=!1);var i=this.addBatchDependency();return this.getShareable().then(function(s){return i(),s.shareWith(e,t,r,n,o)})},r}(le),he=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return(0,t.__extends)(r,e),Object.defineProperty(r.prototype,"webparts",{get:function(){return new fe(this,"webparts")},enumerable:!0,configurable:!0}),r.prototype.export=function(e){return this.clone(r,"ExportWebPart").postCore({body:JSON.stringify({webPartId:e})})},r.prototype.import=function(e){return this.clone(r,"ImportWebPart").postCore({body:JSON.stringify({webPartXml:e})})},r}(I),fe=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return(0,t.__extends)(r,e),r.prototype.getById=function(e){return new ye(this,"getbyid('"+e+"')")},r.prototype.getByControlId=function(e){return new ye(this,"getByControlId('"+e+"')")},r}(_),ye=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return(0,t.__extends)(r,e),Object.defineProperty(r.prototype,"webpart",{get:function(){return new ge(this)},enumerable:!0,configurable:!0}),r.prototype.saveChanges=function(){return this.clone(r,"SaveWebPartChanges").postCore()},r.prototype.moveTo=function(e,t){return this.clone(r,"MoveWebPartTo(zoneID='"+e+"', zoneIndex="+t+")").postCore()},r.prototype.close=function(){return this.clone(r,"CloseWebPart").postCore()},r.prototype.open=function(){return this.clone(r,"OpenWebPart").postCore()},r.prototype.delete=function(){return this.clone(r,"DeleteWebPart").postCore()},r}(O),ge=function(e){function r(t,r){return void 0===r&&(r="webpart"),e.call(this,t,r)||this}return(0,t.__extends)(r,e),r}(O),me=function(e){function r(t,r){return void 0===r&&(r="folders"),e.call(this,t,r)||this}return(0,t.__extends)(r,e),r.prototype.getByName=function(e){var t=new be(this);return t.concat("('"+e+"')"),t},r.prototype.add=function(e){var t=this;return this.clone(r,"add('"+e+"')").postCore().then(function(r){return{data:r,folder:t.getByName(e)}})},r}(_),be=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return(0,t.__extends)(r,e),Object.defineProperty(r.prototype,"contentTypeOrder",{get:function(){return new _(this,"contentTypeOrder")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"files",{get:function(){return new Je(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"folders",{get:function(){return new me(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"listItemAllFields",{get:function(){return new _(this,"listItemAllFields")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"parentFolder",{get:function(){return new r(this,"parentFolder")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"properties",{get:function(){return new O(this,"properties")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"serverRelativeUrl",{get:function(){return new I(this,"serverRelativeUrl")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"uniqueContentTypeOrder",{get:function(){return new _(this,"uniqueContentTypeOrder")},enumerable:!0,configurable:!0}),r.prototype.update=function(e){var t=this,r=JSON.stringify((0,n.extend)({__metadata:{type:"SP.Folder"}},e));return this.postCore({body:r,headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{data:e,folder:t}})},r.prototype.delete=function(e){return void 0===e&&(e="*"),this.clone(r,null).postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},r.prototype.recycle=function(){return this.clone(r,"recycle").postCore()},r.prototype.getItem=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=this.listItemAllFields;return r.select.apply(r,e).get().then(function(e){return(0,n.extend)(new ke(f(e)),e)})},r}(de),ve=function(e){function r(t,r){return void 0===r&&(r="contenttypes"),e.call(this,t,r)||this}return(0,t.__extends)(r,e),r.prototype.getById=function(e){var t=new Pe(this);return t.concat("('"+e+"')"),t},r.prototype.addAvailableContentType=function(e){var t=this,n=JSON.stringify({contentTypeId:e});return this.clone(r,"addAvailableContentType").postCore({body:n}).then(function(e){return{contentType:t.getById(e.id),data:e}})},r.prototype.add=function(e,t,r,o,i){var s=this;void 0===r&&(r=""),void 0===o&&(o="Custom Content Types"),void 0===i&&(i={});var a=JSON.stringify((0,n.extend)({Description:r,Group:o,Id:{StringValue:e},Name:t,__metadata:{type:"SP.ContentType"}},i));return this.postCore({body:a}).then(function(e){return{contentType:s.getById(e.id),data:e}})},r}(_),Pe=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return(0,t.__extends)(r,e),Object.defineProperty(r.prototype,"fieldLinks",{get:function(){return new xe(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"fields",{get:function(){return new _(this,"fields")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"parent",{get:function(){return new r(this,"parent")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"workflowAssociations",{get:function(){return new _(this,"workflowAssociations")},enumerable:!0,configurable:!0}),r.prototype.delete=function(){return this.postCore({headers:{"X-HTTP-Method":"DELETE"}})},r}(O),xe=function(e){function r(t,r){return void 0===r&&(r="fieldlinks"),e.call(this,t,r)||this}return(0,t.__extends)(r,e),r.prototype.getById=function(e){var t=new we(this);return t.concat("(guid'"+e+"')"),t},r}(_),we=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return(0,t.__extends)(r,e),r}(O),Se=function(e){function r(t,r){return void 0===r&&(r="AttachmentFiles"),e.call(this,t,r)||this}return(0,t.__extends)(r,e),r.prototype.getByName=function(e){var t=new Ce(this);return t.concat("('"+e+"')"),t},r.prototype.add=function(e,t){var n=this;return this.clone(r,"add(FileName='"+e+"')",!1).postCore({body:t}).then(function(t){return{data:t,file:n.getByName(e)}})},r.prototype.addMultiple=function(e){var t=this;return e.reduce(function(e,n){return e.then(function(){return t.clone(r,"add(FileName='"+n.name+"')",!1).postCore({body:n.content})})},Promise.resolve())},r.prototype.deleteMultiple=function(){for(var e=this,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return t.reduce(function(t,r){return t.then(function(){return e.getByName(r).delete()})},Promise.resolve())},r}(_),Ce=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return(0,t.__extends)(r,e),r.prototype.getText=function(){return this.getParsed(new o.TextParser)},r.prototype.getBlob=function(){return this.getParsed(new o.BlobParser)},r.prototype.getBuffer=function(){return this.getParsed(new o.BufferParser)},r.prototype.getJSON=function(){return this.getParsed(new o.JSONParser)},r.prototype.setContent=function(e){var t=this;return this.clone(r,"$value",!1).postCore({body:e,headers:{"X-HTTP-Method":"PUT"}}).then(function(e){return new r(t)})},r.prototype.delete=function(e){return void 0===e&&(e="*"),this.postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},r.prototype.getParsed=function(e){return this.clone(r,"$value",!1).get(e)},r}(O),Te=function(e){function r(t,r){return void 0===r&&(r="views"),e.call(this,t,r)||this}return(0,t.__extends)(r,e),r.prototype.getById=function(e){var t=new Ie(this);return t.concat("('"+e+"')"),t},r.prototype.getByTitle=function(e){return new Ie(this,"getByTitle('"+e+"')")},r.prototype.add=function(e,t,o){var i=this;void 0===t&&(t=!1),void 0===o&&(o={});var s=JSON.stringify((0,n.extend)({PersonalView:t,Title:e,__metadata:{type:"SP.View"}},o));return this.clone(r,null).postCore({body:s}).then(function(e){return{data:e,view:i.getById(e.Id)}})},r}(_),Ie=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return(0,t.__extends)(r,e),Object.defineProperty(r.prototype,"fields",{get:function(){return new _e(this)},enumerable:!0,configurable:!0}),r.prototype.update=function(e){var t=this,r=JSON.stringify((0,n.extend)({__metadata:{type:"SP.View"}},e));return this.postCore({body:r,headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{data:e,view:t}})},r.prototype.delete=function(){return this.postCore({headers:{"X-HTTP-Method":"DELETE"}})},r.prototype.renderAsHtml=function(){return this.clone(I,"renderashtml").get()},r}(O),_e=function(e){function r(t,r){return void 0===r&&(r="viewfields"),e.call(this,t,r)||this}return(0,t.__extends)(r,e),r.prototype.getSchemaXml=function(){return this.clone(I,"schemaxml").get()},r.prototype.add=function(e){return this.clone(r,"addviewfield('"+e+"')").postCore()},r.prototype.move=function(e,t){return this.clone(r,"moveviewfieldto").postCore({body:JSON.stringify({field:e,index:t})})},r.prototype.removeAll=function(){return this.clone(r,"removeallviewfields").postCore()},r.prototype.remove=function(e){return this.clone(r,"removeviewfield('"+e+"')").postCore()},r}(_),Oe=function(e){function r(t,r){return void 0===r&&(r="fields"),e.call(this,t,r)||this}return(0,t.__extends)(r,e),r.prototype.getByTitle=function(e){return new Fe(this,"getByTitle('"+e+"')")},r.prototype.getByInternalNameOrTitle=function(e){return new Fe(this,"getByInternalNameOrTitle('"+e+"')")},r.prototype.getById=function(e){var t=new Fe(this);return t.concat("('"+e+"')"),t},r.prototype.createFieldAsXml=function(e){var t,o=this;t="string"==typeof e?{SchemaXml:e}:e;var i=JSON.stringify({parameters:(0,n.extend)({__metadata:{type:"SP.XmlSchemaFieldCreationInformation"}},t)});return this.clone(r,"createfieldasxml").postCore({body:i}).then(function(e){return{data:e,field:o.getById(e.Id)}})},r.prototype.add=function(e,t,o){var i=this,s=JSON.stringify((0,n.extend)({Title:e,__metadata:{type:t}},o));return this.clone(r,null).postCore({body:s}).then(function(e){return{data:e,field:i.getById(e.Id)}})},r.prototype.addText=function(e,t,r){void 0===t&&(t=255);var o={FieldTypeKind:2,MaxLength:t};return this.add(e,"SP.FieldText",(0,n.extend)(o,r))},r.prototype.addCalculated=function(e,t,r,o,i){void 0===o&&(o=U.Text);var s={DateFormat:r,FieldTypeKind:17,Formula:t,OutputType:o};return this.add(e,"SP.FieldCalculated",(0,n.extend)(s,i))},r.prototype.addDateTime=function(e,t,r,o,i){void 0===t&&(t=B.DateOnly),void 0===r&&(r=N.Gregorian),void 0===o&&(o=0);var s={DateTimeCalendarType:r,DisplayFormat:t,FieldTypeKind:4,FriendlyDisplayFormat:o};return this.add(e,"SP.FieldDateTime",(0,n.extend)(s,i))},r.prototype.addNumber=function(e,t,r,o){var i={FieldTypeKind:9};return void 0!==t&&(i=(0,n.extend)({MinimumValue:t},i)),void 0!==r&&(i=(0,n.extend)({MaximumValue:r},i)),this.add(e,"SP.FieldNumber",(0,n.extend)(i,o))},r.prototype.addCurrency=function(e,t,r,o,i){void 0===o&&(o=1033);var s={CurrencyLocaleId:o,FieldTypeKind:10};return void 0!==t&&(s=(0,n.extend)({MinimumValue:t},s)),void 0!==r&&(s=(0,n.extend)({MaximumValue:r},s)),this.add(e,"SP.FieldCurrency",(0,n.extend)(s,i))},r.prototype.addMultilineText=function(e,t,r,o,i,s,a){void 0===t&&(t=6),void 0===r&&(r=!0),void 0===o&&(o=!1),void 0===i&&(i=!1),void 0===s&&(s=!0);var u={AllowHyperlink:s,AppendOnly:i,FieldTypeKind:3,NumberOfLines:t,RestrictedMode:o,RichText:r};return this.add(e,"SP.FieldMultiLineText",(0,n.extend)(u,a))},r.prototype.addUrl=function(e,t,r){void 0===t&&(t=j.Hyperlink);var o={DisplayFormat:t,FieldTypeKind:11};return this.add(e,"SP.FieldUrl",(0,n.extend)(o,r))},r.prototype.addUser=function(e,t,r){var o={FieldTypeKind:20,SelectionMode:t};return this.add(e,"SP.FieldUser",(0,n.extend)(o,r))},r.prototype.addLookup=function(e,t,o,i){var s=this,a=JSON.stringify({parameters:(0,n.extend)({FieldTypeKind:7,LookupFieldName:o,LookupListId:t,Title:e,__metadata:{type:"SP.FieldCreationInformation"}},i)});return this.clone(r,"addfield").postCore({body:a}).then(function(e){return{data:e,field:s.getById(e.Id)}})},r.prototype.addChoice=function(e,t,r,o,i){void 0===r&&(r=K.Dropdown);var s={Choices:{results:t},EditFormat:r,FieldTypeKind:6,FillInChoice:o};return this.add(e,"SP.FieldChoice",(0,n.extend)(s,i))},r.prototype.addMultiChoice=function(e,t,r,o){var i={Choices:{results:t},FieldTypeKind:15,FillInChoice:r};return this.add(e,"SP.FieldMultiChoice",(0,n.extend)(i,o))},r.prototype.addBoolean=function(e,t){return this.add(e,"SP.Field",(0,n.extend)({FieldTypeKind:8},t))},r}(_),Fe=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return(0,t.__extends)(r,e),r.prototype.update=function(e,t){var r=this;void 0===t&&(t="SP.Field");var o=JSON.stringify((0,n.extend)({__metadata:{type:t}},e));return this.postCore({body:o,headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{data:e,field:r}})},r.prototype.delete=function(){return this.postCore({headers:{"X-HTTP-Method":"DELETE"}})},r.prototype.setShowInDisplayForm=function(e){return this.clone(r,"setshowindisplayform("+e+")").postCore()},r.prototype.setShowInEditForm=function(e){return this.clone(r,"setshowineditform("+e+")").postCore()},r.prototype.setShowInNewForm=function(e){return this.clone(r,"setshowinnewform("+e+")").postCore()},r}(O),De=function(e){function r(t,r){return void 0===r&&(r="forms"),e.call(this,t,r)||this}return(0,t.__extends)(r,e),r.prototype.getById=function(e){var t=new Re(this);return t.concat("('"+e+"')"),t},r}(_),Re=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return(0,t.__extends)(r,e),r}(O),Le=function(e){function r(t,r){return void 0===r&&(r="subscriptions"),e.call(this,t,r)||this}return(0,t.__extends)(r,e),r.prototype.getById=function(e){var t=new Ue(this);return t.concat("('"+e+"')"),t},r.prototype.add=function(e,t,r){var n=this,o=JSON.stringify({clientState:r||"pnp-js-core-subscription",expirationDateTime:t,notificationUrl:e,resource:this.toUrl()});return this.postCore({body:o,headers:{"Content-Type":"application/json"}}).then(function(e){return{data:e,subscription:n.getById(e.id)}})},r}(_),Ue=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return(0,t.__extends)(r,e),r.prototype.update=function(e){var t=this,r=JSON.stringify({expirationDateTime:e});return this.patchCore({body:r,headers:{"Content-Type":"application/json"}}).then(function(e){return{data:e,subscription:t}})},r.prototype.delete=function(){return e.prototype.deleteCore.call(this)},r}(O),Be=function(e){function r(t,r){return void 0===r&&(r="usercustomactions"),e.call(this,t,r)||this}return(0,t.__extends)(r,e),r.prototype.getById=function(e){var t=new Ee(this);return t.concat("('"+e+"')"),t},r.prototype.add=function(e){var t=this,r=JSON.stringify((0,n.extend)({__metadata:{type:"SP.UserCustomAction"}},e));return this.postCore({body:r}).then(function(e){return{action:t.getById(e.Id),data:e}})},r.prototype.clear=function(){return this.clone(r,"clear").postCore()},r}(_),Ee=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return(0,t.__extends)(r,e),r.prototype.update=function(e){var t=this,r=JSON.stringify((0,n.extend)({__metadata:{type:"SP.UserCustomAction"}},e));return this.postCore({body:r,headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{action:t,data:e}})},r.prototype.delete=function(){return e.prototype.deleteCore.call(this)},r}(O),Ne=function(e){function r(t,r){return void 0===r&&(r="lists"),e.call(this,t,r)||this}return(0,t.__extends)(r,e),r.prototype.getByTitle=function(e){return new je(this,"getByTitle('"+e+"')")},r.prototype.getById=function(e){var t=new je(this);return t.concat("('"+e+"')"),t},r.prototype.add=function(e,t,r,o,i){var s=this;void 0===t&&(t=""),void 0===r&&(r=100),void 0===o&&(o=!1),void 0===i&&(i={});var a=(0,n.extend)({AllowContentTypes:o,BaseTemplate:r,ContentTypesEnabled:o,Description:t,Title:e,__metadata:{type:"SP.List"}},i);return this.postCore({body:JSON.stringify(a)}).then(function(e){return{data:e,list:s.getByTitle(a.Title)}})},r.prototype.ensure=function(e,t,r,o,i){var s=this;if(void 0===t&&(t=""),void 0===r&&(r=100),void 0===o&&(o=!1),void 0===i&&(i={}),this.hasBatch)throw new p("The ensure list method");return new Promise(function(a,u){var p=(0,n.extend)(i,{Title:e,Description:t,ContentTypesEnabled:o},!0),l=s.getByTitle(p.Title);l.get().then(function(e){l.update(p).then(function(e){a({created:!1,data:e,list:s.getByTitle(p.Title)})}).catch(function(e){return u(e)})}).catch(function(n){s.add(e,t,r,o,p).then(function(e){a({created:!0,data:e.data,list:s.getByTitle(p.Title)})}).catch(function(e){return u(e)})})})},r.prototype.ensureSiteAssetsLibrary=function(){return this.clone(r,"ensuresiteassetslibrary").postCore().then(function(e){return new je(c(e))})},r.prototype.ensureSitePagesLibrary=function(){return this.clone(r,"ensuresitepageslibrary").postCore().then(function(e){return new je(c(e))})},r}(_),je=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return(0,t.__extends)(r,e),Object.defineProperty(r.prototype,"contentTypes",{get:function(){return new ve(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"items",{get:function(){return new Ae(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"views",{get:function(){return new Te(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"fields",{get:function(){return new Oe(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"forms",{get:function(){return new De(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"defaultView",{get:function(){return new Ie(this,"DefaultView")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"userCustomActions",{get:function(){return new Be(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"effectiveBasePermissions",{get:function(){return new I(this,"EffectiveBasePermissions")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"eventReceivers",{get:function(){return new _(this,"EventReceivers")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"relatedFields",{get:function(){return new I(this,"getRelatedFields")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"informationRightsManagementSettings",{get:function(){return new I(this,"InformationRightsManagementSettings")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"subscriptions",{get:function(){return new Le(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"rootFolder",{get:function(){return new be(this,"rootFolder")},enumerable:!0,configurable:!0}),r.prototype.getView=function(e){return new Ie(this,"getView('"+e+"')")},r.prototype.update=function(e,t){var o=this;void 0===t&&(t="*");var i=JSON.stringify((0,n.extend)({__metadata:{type:"SP.List"}},e));return this.postCore({body:i,headers:{"IF-Match":t,"X-HTTP-Method":"MERGE"}}).then(function(t){var n=o;return e.hasOwnProperty("Title")&&(n=o.getParent(r,o.parentUrl,"getByTitle('"+e.Title+"')")),{data:t,list:n}})},r.prototype.delete=function(e){return void 0===e&&(e="*"),this.postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},r.prototype.getChanges=function(e){return this.clone(r,"getchanges").postCore({body:JSON.stringify({query:(0,n.extend)({__metadata:{type:"SP.ChangeQuery"}},e)})})},r.prototype.getItemsByCAMLQuery=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];var i=this.clone(r,"getitems");return i.expand.apply(i,t).postCore({body:JSON.stringify({query:(0,n.extend)({__metadata:{type:"SP.CamlQuery"}},e)})})},r.prototype.getListItemChangesSinceToken=function(e){return this.clone(r,"getlistitemchangessincetoken").postCore({body:JSON.stringify({query:(0,n.extend)({__metadata:{type:"SP.ChangeLogItemQuery"}},e)})},{parse:function(e){return e.text()}})},r.prototype.recycle=function(){return this.clone(r,"recycle").postCore().then(function(e){return e.hasOwnProperty("Recycle")?e.Recycle:e})},r.prototype.renderListData=function(e){var t=this.clone(r,"renderlistdata(@viewXml)");return t.query.add("@viewXml","'"+e+"'"),t.postCore().then(function(e){return(e=JSON.parse(e)).hasOwnProperty("RenderListData")?e.RenderListData:e})},r.prototype.renderListDataAsStream=function(e,t){void 0===t&&(t=null);var o={overrideParameters:(0,n.extend)({__metadata:{type:"SP.RenderListDataOverrideParameters"}},t),parameters:(0,n.extend)({__metadata:{type:"SP.RenderListDataParameters"}},e)};return this.clone(r,"RenderListDataAsStream",!0).postCore({body:JSON.stringify(o)})},r.prototype.renderListFormData=function(e,t,n){return this.clone(r,"renderlistformdata(itemid="+e+", formid='"+t+"', mode='"+n+"')").postCore().then(function(e){return(e=JSON.parse(e)).hasOwnProperty("ListData")?e.ListData:e})},r.prototype.reserveListItemId=function(){return this.clone(r,"reservelistitemid").postCore().then(function(e){return e.hasOwnProperty("ReserveListItemId")?e.ReserveListItemId:e})},r.prototype.getListItemEntityTypeFullName=function(){return this.clone(r,null,!1).select("ListItemEntityTypeFullName").get().then(function(e){return e.ListItemEntityTypeFullName})},r}(se),Ae=function(e){function o(t,r){return void 0===r&&(r="items"),e.call(this,t,r)||this}return(0,t.__extends)(o,e),o.prototype.getById=function(e){var t=new ke(this);return t.concat("("+e+")"),t},o.prototype.getItemByStringId=function(e){return new ke(this.parentUrl,"getItemByStringId('"+e+"')")},o.prototype.skip=function(e,t){return void 0===t&&(t=!1),t?this._query.add("$skiptoken",encodeURIComponent("Paged=TRUE&PagedPrev=TRUE&p_ID="+e)):this._query.add("$skiptoken",encodeURIComponent("Paged=TRUE&p_ID="+e)),this},o.prototype.getPaged=function(){return this.get(new He(this))},o.prototype.getAll=function(e){var t=this;void 0===e&&(e=2e3),r.Logger.write("Calling items.getAll should be done sparingly. Ensure this is the correct choice. If you are unsure, it is not.",2);var n=new o(this,"").top(e).configure({headers:{Accept:"application/json;odata=nometadata"}});return this.query.getKeys().filter(function(e){return/^\$select$|^\$filter$|^\$top$|^\$expand$/.test(e.toLowerCase())}).reduce(function(e,r){return e.query.add(r,t.query.get(r)),e},n),new Promise(function(e,t){var r=[],o=function(n){[].push.apply(r,n.results),n.hasNext?n.getNext().then(o).catch(t):e(r)};n.getPaged().then(o).catch(t)})},o.prototype.add=function(e,t){var r=this;void 0===e&&(e={}),void 0===t&&(t=null);var i=this.addBatchDependency();return this.ensureListItemEntityTypeName(t).then(function(t){var s=JSON.stringify((0,n.extend)({__metadata:{type:t}},e)),a=r.clone(o,null).postCore({body:s}).then(function(e){return{data:e,item:r.getById(e.Id)}});return i(),a})},o.prototype.ensureListItemEntityTypeName=function(e){return e?Promise.resolve(e):this.getParent(je).getListItemEntityTypeFullName()},o}(_),ke=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return(0,t.__extends)(r,e),Object.defineProperty(r.prototype,"attachmentFiles",{get:function(){return new Se(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"contentType",{get:function(){return new Pe(this,"ContentType")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"effectiveBasePermissions",{get:function(){return new I(this,"EffectiveBasePermissions")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"effectiveBasePermissionsForUI",{get:function(){return new I(this,"EffectiveBasePermissionsForUI")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"fieldValuesAsHTML",{get:function(){return new O(this,"FieldValuesAsHTML")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"fieldValuesAsText",{get:function(){return new O(this,"FieldValuesAsText")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"fieldValuesForEdit",{get:function(){return new O(this,"FieldValuesForEdit")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"folder",{get:function(){return new be(this,"folder")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"file",{get:function(){return new We(this,"file")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"versions",{get:function(){return new Me(this)},enumerable:!0,configurable:!0}),r.prototype.update=function(e,t,r){var o=this;return void 0===t&&(t="*"),void 0===r&&(r=null),new Promise(function(i,s){var a=o.addBatchDependency();return o.ensureListItemEntityTypeName(r).then(function(r){var s=JSON.stringify((0,n.extend)({__metadata:{type:r}},e));return a(),o.postCore({body:s,headers:{"IF-Match":t,"X-HTTP-Method":"MERGE"}},new Ve).then(function(e){i({data:e,item:o})})}).catch(function(e){return s(e)})})},r.prototype.delete=function(e){return void 0===e&&(e="*"),this.postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},r.prototype.recycle=function(){return this.clone(r,"recycle").postCore()},r.prototype.getWopiFrameUrl=function(e){void 0===e&&(e=0);var t=this.clone(r,"getWOPIFrameUrl(@action)");return t._query.add("@action",e),t.postCore().then(function(e){return e.hasOwnProperty("GetWOPIFrameUrl")?e.GetWOPIFrameUrl:e})},r.prototype.validateUpdateListItem=function(e,t){return void 0===t&&(t=!1),this.clone(r,"validateupdatelistitem").postCore({body:JSON.stringify({formValues:e,bNewDocumentUpdate:t})})},r.prototype.ensureListItemEntityTypeName=function(e){return e?Promise.resolve(e):this.getParent(je,this.parentUrl.substr(0,this.parentUrl.lastIndexOf("/"))).getListItemEntityTypeFullName()},r}(pe),Me=function(e){function r(t,r){return void 0===r&&(r="versions"),e.call(this,t,r)||this}return(0,t.__extends)(r,e),r.prototype.getById=function(e){var t=new qe(this);return t.concat("("+e+")"),t},r}(_),qe=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return(0,t.__extends)(r,e),r.prototype.delete=function(){return this.postCore({headers:{"X-HTTP-Method":"DELETE"}})},r}(O),Qe=function(){function e(e,t,r){this.parent=e,this.nextUrl=t,this.results=r}return Object.defineProperty(e.prototype,"hasNext",{get:function(){return"string"==typeof this.nextUrl&&this.nextUrl.length>0},enumerable:!0,configurable:!0}),e.prototype.getNext=function(){return this.hasNext?new Ae(this.nextUrl,null).configureFrom(this.parent).getPaged():new Promise(function(e){return e(null)})},e}(),He=function(e){function r(t){var r=e.call(this)||this;return r._parent=t,r}return(0,t.__extends)(r,e),r.prototype.parse=function(e){var t=this;return new Promise(function(r,n){t.handleError(e,n)&&e.json().then(function(e){var n=e.hasOwnProperty("d")&&e.d.hasOwnProperty("__next")?e.d.__next:e["odata.nextLink"];r(new Qe(t._parent,n,t.parseODataJSON(e)))})})},r}(o.ODataParserBase),Ve=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return(0,t.__extends)(r,e),r.prototype.parse=function(e){var t=this;return new Promise(function(r,n){t.handleError(e,n)&&r({"odata.etag":e.headers.get("etag")})})},r}(o.ODataParserBase),Je=function(e){function r(t,r){return void 0===r&&(r="files"),e.call(this,t,r)||this}return(0,t.__extends)(r,e),r.prototype.getByName=function(e){var t=new We(this);return t.concat("('"+e+"')"),t},r.prototype.add=function(e,t,n){var o=this;return void 0===n&&(n=!0),new r(this,"add(overwrite="+n+",url='"+e+"')").postCore({body:t}).then(function(t){return{data:t,file:o.getByName(e)}})},r.prototype.addChunked=function(e,t,n,o,i){var s=this;return void 0===o&&(o=!0),void 0===i&&(i=10485760),this.clone(r,"add(overwrite="+o+",url='"+e+"')",!1).postCore().then(function(){return s.getByName(e)}).then(function(e){return e.setContentChunked(t,n,i)})},r.prototype.addTemplateFile=function(e,t){var n=this;return this.clone(r,"addTemplateFile(urloffile='"+e+"',templatefiletype="+t+")",!1).postCore().then(function(t){return{data:t,file:n.getByName(e)}})},r}(_),We=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return(0,t.__extends)(r,e),Object.defineProperty(r.prototype,"listItemAllFields",{get:function(){return new _(this,"listItemAllFields")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"versions",{get:function(){return new Ge(this)},enumerable:!0,configurable:!0}),r.prototype.approve=function(e){return void 0===e&&(e=""),this.clone(r,"approve(comment='"+e+"')").postCore()},r.prototype.cancelUpload=function(e){return this.clone(r,"cancelUpload(uploadId=guid'"+e+"')",!1).postCore()},r.prototype.checkin=function(e,t){if(void 0===e&&(e=""),void 0===t&&(t=re.Major),e.length>1023)throw new u;return this.clone(r,"checkin(comment='"+e+"',checkintype="+t+")").postCore()},r.prototype.checkout=function(){return this.clone(r,"checkout").postCore()},r.prototype.copyTo=function(e,t){return void 0===t&&(t=!0),this.clone(r,"copyTo(strnewurl='"+e+"',boverwrite="+t+")").postCore()},r.prototype.delete=function(e){return void 0===e&&(e="*"),this.clone(r,null).postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},r.prototype.deny=function(e){if(void 0===e&&(e=""),e.length>1023)throw new u;return this.clone(r,"deny(comment='"+e+"')").postCore()},r.prototype.getLimitedWebPartManager=function(e){return void 0===e&&(e=ne.Shared),new he(this,"getLimitedWebPartManager(scope="+e+")")},r.prototype.moveTo=function(e,t){return void 0===t&&(t=oe.Overwrite),this.clone(r,"moveTo(newurl='"+e+"',flags="+t+")").postCore()},r.prototype.publish=function(e){if(void 0===e&&(e=""),e.length>1023)throw new u;return this.clone(r,"publish(comment='"+e+"')").postCore()},r.prototype.recycle=function(){return this.clone(r,"recycle").postCore()},r.prototype.undoCheckout=function(){return this.clone(r,"undoCheckout").postCore()},r.prototype.unpublish=function(e){if(void 0===e&&(e=""),e.length>1023)throw new u;return this.clone(r,"unpublish(comment='"+e+"')").postCore()},r.prototype.getText=function(){return this.clone(r,"$value",!1).get(new o.TextParser,{headers:{binaryStringResponseBody:"true"}})},r.prototype.getBlob=function(){return this.clone(r,"$value",!1).get(new o.BlobParser,{headers:{binaryStringResponseBody:"true"}})},r.prototype.getBuffer=function(){return this.clone(r,"$value",!1).get(new o.BufferParser,{headers:{binaryStringResponseBody:"true"}})},r.prototype.getJSON=function(){return this.clone(r,"$value",!1).get(new o.JSONParser,{headers:{binaryStringResponseBody:"true"}})},r.prototype.setContent=function(e){var t=this;return this.clone(r,"$value",!1).postCore({body:e,headers:{"X-HTTP-Method":"PUT"}}).then(function(e){return new r(t)})},r.prototype.getItem=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=this.listItemAllFields;return r.select.apply(r,e).get().then(function(e){return(0,n.extend)(new ke(f(e)),e)})},r.prototype.setContentChunked=function(e,t,r){var o=this;void 0===r&&(r=10485760),void 0===t&&(t=function(){return null});var i=e.size,s=parseInt((e.size/r).toString(),10)+(e.size%r==0?1:0),a=(0,n.getGUID)();t({uploadId:a,blockNumber:1,chunkSize:r,currentPointer:0,fileSize:i,stage:"starting",totalBlocks:s});for(var u=this.startUpload(a,e.slice(0,r)),p=function(n){u=u.then(function(u){return t({uploadId:a,blockNumber:n,chunkSize:r,currentPointer:u,fileSize:i,stage:"continue",totalBlocks:s}),o.continueUpload(a,u,e.slice(u,u+r))})},l=2;l<s;l++)p(l);return u.then(function(n){return t({uploadId:a,blockNumber:s,chunkSize:r,currentPointer:n,fileSize:i,stage:"finishing",totalBlocks:s}),o.finishUpload(a,n,e.slice(n))})},r.prototype.startUpload=function(e,t){return this.clone(r,"startUpload(uploadId=guid'"+e+"')",!1).postCore({body:t}).then(function(e){return"object"==typeof e&&(e=e.StartUpload),parseFloat(e)})},r.prototype.continueUpload=function(e,t,n){return this.clone(r,"continueUpload(uploadId=guid'"+e+"',fileOffset="+t+")",!1).postCore({body:n}).then(function(e){return"object"==typeof e&&(e=e.ContinueUpload),parseFloat(e)})},r.prototype.finishUpload=function(e,t,n){return this.clone(r,"finishUpload(uploadId=guid'"+e+"',fileOffset="+t+")",!1).postCore({body:n}).then(function(e){return{data:e,file:new r(e.ServerRelativeUrl)}})},r}(ce),Ge=function(e){function r(t,r){return void 0===r&&(r="versions"),e.call(this,t,r)||this}return(0,t.__extends)(r,e),r.prototype.getById=function(e){var t=new Ke(this);return t.concat("("+e+")"),t},r.prototype.deleteAll=function(){return new r(this,"deleteAll").postCore()},r.prototype.deleteById=function(e){return this.clone(r,"deleteById(vid="+e+")").postCore()},r.prototype.recycleByID=function(e){return this.clone(r,"recycleByID(vid="+e+")").postCore()},r.prototype.deleteByLabel=function(e){return this.clone(r,"deleteByLabel(versionlabel='"+e+"')").postCore()},r.prototype.recycleByLabel=function(e){return this.clone(r,"recycleByLabel(versionlabel='"+e+"')").postCore()},r.prototype.restoreByLabel=function(e){return this.clone(r,"restoreByLabel(versionlabel='"+e+"')").postCore()},r}(_),Ke=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return(0,t.__extends)(r,e),r.prototype.delete=function(e){return void 0===e&&(e="*"),this.postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},r}(O);!function(e){e[e.Minor=0]="Minor",e[e.Major=1]="Major",e[e.Overwrite=2]="Overwrite"}(re||(exports.CheckinType=re={})),function(e){e[e.User=0]="User",e[e.Shared=1]="Shared"}(ne||(exports.WebPartsPersonalizationScope=ne={})),function(e){e[e.Overwrite=1]="Overwrite",e[e.AllowBrokenThickets=8]="AllowBrokenThickets"}(oe||(exports.MoveOperations=oe={})),function(e){e[e.StandardPage=0]="StandardPage",e[e.WikiPage=1]="WikiPage",e[e.FormPage=2]="FormPage",e[e.ClientSidePage=3]="ClientSidePage"}(ie||(exports.TemplateFileType=ie={}));var Xe=function(e){function r(t,r){void 0===r&&(r="_api/web/tenantappcatalog/AvailableApps");var n="";return"string"==typeof t?n=t:void 0!==t&&(n=t.toUrl()),e.call(this,i(n),r)||this}return(0,t.__extends)(r,e),r.prototype.getAppById=function(e){return new ze(this,"getById('"+e+"')")},r.prototype.add=function(e,t,n){return void 0===n&&(n=!0),new r(i(this.toUrl()),"_api/web/tenantappcatalog/add(overwrite="+n+",url='"+e+"')").postCore({body:t}).then(function(e){return{data:e,file:new We(c(e))}})},r}(_),ze=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return(0,t.__extends)(r,e),r.prototype.deploy=function(){return this.clone(r,"Deploy").postCore()},r.prototype.retract=function(){return this.clone(r,"Retract").postCore()},r.prototype.install=function(){return this.clone(r,"Install").postCore()},r.prototype.uninstall=function(){return this.clone(r,"Uninstall").postCore()},r.prototype.upgrade=function(){return this.clone(r,"Upgrade").postCore()},r.prototype.remove=function(){return this.clone(r,"Remove").postCore()},r}(O);function $e(e){return e.length<1?1:Math.max.apply(null,e.map(function(e){return e.order}))+1}function Ze(e,t){void 0===t&&(t=0);var r=this.substring(t).search(e);return r>=0?r+t:r}function Ye(e,t){var r=new RegExp(t+'="([^"]*?)"',"i").exec(e);return r.length>0?r[1]:null}function et(e,t,r){var n=[];if(void 0===e||null===e)return n;var o=e.replace(/[\t\r\n]/g,""),i=Ze.call(o,t);if(i<0)return n;for(;i>-1;){for(var s=1,a=i+1,u=-1,p=-1;;){if(u=Ze.call(o,/<div[^>]*>/i,a),p=Ze.call(o,/<\/div>/i,a),u<0&&(u=o.length+1),u<p?(s++,a=u+1):p<u&&(s--,a=p+1),0===s){var l=o.substring(i,p+6).trim();n.push(r(l));break}if(s>1e3||s<0)throw new Error("getBoundedDivMarkup exceeded depth parameters.")}i=Ze.call(o,t,p)}return n}function tt(e){for(var t=0;t<e.length;t++)e[t].order=t+1,e[t].hasOwnProperty("columns")?tt(e[t].columns):e[t].hasOwnProperty("controls")&&tt(e[t].controls)}var rt,nt,ot,it=function(e){function r(t,r,n){void 0===r&&(r=[]),void 0===n&&(n=!1);var o=e.call(this,t)||this;return o.sections=r,o.commentsDisabled=n,o}return(0,t.__extends)(r,e),r.create=function(e,t,o,i){return void 0===i&&(i="Article"),e.rootFolder.files.select("Name").filter("Name eq '"+t+"'").get().then(function(s){if(s.length>0)throw new Error("A file with the name '"+t+"' already exists in the library '"+e.toUrl()+"'.");return e.rootFolder.select("ServerRelativePath").get().then(function(s){var a=(0,n.combinePaths)("/",s.ServerRelativePath.DecodedUrl,t);return e.rootFolder.files.addTemplateFile(a,ie.ClientSidePage).then(function(e){return e.file.getItem().then(function(e){return e.update({BannerImageUrl:{Url:"/_layouts/15/images/sitepagethumbnail.png"},CanvasContent1:"",ClientSideApplicationId:"b6917cb1-93a0-4b97-a84d-7cf49975d4ec",ContentTypeId:"0x0101009D1CB255DA76424F860D91F20E6C4118",PageLayoutType:i,PromotedState:0,Title:o}).then(function(e){return new r(e.item.file,e.item.CommentsDisabled)})})})})})},r.fromFile=function(e){var t=new r(e);return t.load().then(function(e){return t})},r.jsonToEscapedString=function(e){return JSON.stringify(e).replace(/"/g,"&quot;").replace(/:/g,"&#58;").replace(/{/g,"&#123;").replace(/}/g,"&#125;")},r.escapedStringToJson=function(e){return JSON.parse(e.replace(/&quot;/g,'"').replace(/&#58;/g,":").replace(/&#123;/g,"{").replace(/&#125;/g,"}"))},r.prototype.addSection=function(){var e=new st(this,$e(this.sections));return this.sections.push(e),e},r.prototype.toHtml=function(){tt(this.sections);var e=[];e.push("<div>");for(var t=0;t<this.sections.length;t++)e.push(this.sections[t].toHtml());return e.push("</div>"),e.join("")},r.prototype.fromHtml=function(e){var t=this;return this.sections=[],et(e,/<div\b[^>]*data-sp-canvascontrol[^>]*?>/i,function(e){var r=/controlType&quot;&#58;(\d*?),/i.exec(e),n=null;switch(null==r||r.length<2?0:parseInt(r[1],10)){case 0:(n=new ut(null,0)).fromHtml(e),t.mergeColumnToTree(n);break;case 3:(n=new ct("")).fromHtml(e),t.mergePartToTree(n);break;case 4:(n=new lt).fromHtml(e),t.mergePartToTree(n)}}),tt(this.sections),this},r.prototype.load=function(){var e=this;return this.getItem("CanvasContent1","CommentsDisabled").then(function(t){e.fromHtml(t.CanvasContent1),e.commentsDisabled=t.CommentsDisabled})},r.prototype.save=function(){return this.updateProperties({CanvasContent1:this.toHtml()})},r.prototype.enableComments=function(){var e=this;return this.setCommentsOn(!0).then(function(t){return e.commentsDisabled=!1,t})},r.prototype.disableComments=function(){var e=this;return this.setCommentsOn(!1).then(function(t){return e.commentsDisabled=!0,t})},r.prototype.findControlById=function(e){return this.findControl(function(t){return t.id===e})},r.prototype.findControl=function(e){for(var t=0;t<this.sections.length;t++)for(var r=0;r<this.sections[t].columns.length;r++)for(var n=0;n<this.sections[t].columns[r].controls.length;n++)if(e(this.sections[t].columns[r].controls[n]))return this.sections[t].columns[r].controls[n];return null},r.prototype.setCommentsOn=function(e){return this.getItem().then(function(t){return new ke(t,"SetCommentsDisabled("+!e+")").update({})})},r.prototype.mergePartToTree=function(e){var t=null,r=null,n=this.sections.filter(function(t){return t.order===e.controlData.position.zoneIndex});n.length<1?(t=new st(this,e.controlData.position.zoneIndex),this.sections.push(t)):t=n[0];var o=t.columns.filter(function(t){return t.order===e.controlData.position.sectionIndex});o.length<1?(r=new ut(t,e.controlData.position.sectionIndex,e.controlData.position.sectionFactor),t.columns.push(r)):r=o[0],e.column=r,r.addControl(e)},r.prototype.mergeColumnToTree=function(e){var t=null,r=this.sections.filter(function(t){return t.order===e.controlData.position.zoneIndex});r.length<1?(t=new st(this,e.controlData.position.zoneIndex),this.sections.push(t)):t=r[0],e.section=t,t.columns.push(e)},r.prototype.updateProperties=function(e,t){return void 0===t&&(t="*"),this.getItem().then(function(r){return r.update(e,t)})},r}(We),st=function(){function e(e,t,r){void 0===r&&(r=[]),this.page=e,this.order=t,this.columns=r,this._memId=(0,n.getGUID)()}return Object.defineProperty(e.prototype,"defaultColumn",{get:function(){return this.columns.length<1&&this.addColumn(12),this.columns[0]},enumerable:!0,configurable:!0}),e.prototype.addColumn=function(e){var t=new ut(this,$e(this.columns),e);return this.columns.push(t),t},e.prototype.addControl=function(e){return this.defaultColumn.addControl(e),this},e.prototype.toHtml=function(){for(var e=[],t=0;t<this.columns.length;t++)e.push(this.columns[t].toHtml());return e.join("")},e.prototype.remove=function(){var e=this;this.page.sections=this.page.sections.filter(function(t){return t._memId!==e._memId}),tt(this.page.sections)},e}(),at=function(){function e(e,t,r,o,i,s){void 0===r&&(r=null),void 0===o&&(o=1),void 0===i&&(i=(0,n.getGUID)()),void 0===s&&(s=null),this.controlType=e,this.dataVersion=t,this.column=r,this.order=o,this.id=i,this.controlData=s}return Object.defineProperty(e.prototype,"jsonData",{get:function(){return it.jsonToEscapedString(this.getControlData())},enumerable:!0,configurable:!0}),e.prototype.fromHtml=function(e){this.controlData=it.escapedStringToJson(Ye(e,"data-sp-controldata")),this.dataVersion=Ye(e,"data-sp-canvasdataversion"),this.controlType=this.controlData.controlType,this.id=this.controlData.id},e}(),ut=function(e){function r(t,r,n,o,i){void 0===n&&(n=12),void 0===o&&(o=[]),void 0===i&&(i="1.0");var s=e.call(this,0,i)||this;return s.section=t,s.order=r,s.factor=n,s.controls=o,s}return(0,t.__extends)(r,e),r.prototype.addControl=function(e){return e.column=this,this.controls.push(e),this},r.prototype.getControl=function(e){return this.controls[e]},r.prototype.toHtml=function(){var e=[];if(this.controls.length<1)e.push('<div data-sp-canvascontrol="" data-sp-canvasdataversion="'+this.dataVersion+'" data-sp-controldata="'+this.jsonData+'"></div>');else for(var t=0;t<this.controls.length;t++)e.push(this.controls[t].toHtml(t+1));return e.join("")},r.prototype.fromHtml=function(t){e.prototype.fromHtml.call(this,t),this.controlData=it.escapedStringToJson(Ye(t,"data-sp-controldata")),this.factor=this.controlData.position.sectionFactor,this.order=this.controlData.position.sectionIndex},r.prototype.getControlData=function(){return{displayMode:2,position:{sectionFactor:this.factor,sectionIndex:this.order,zoneIndex:this.section.order}}},r.prototype.remove=function(){var e=this;this.section.columns=this.section.columns.filter(function(t){return t.id!==e.id}),tt(this.column.controls)},r}(at),pt=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return(0,t.__extends)(r,e),r.prototype.remove=function(){var e=this;this.column.controls=this.column.controls.filter(function(t){return t.id!==e.id}),tt(this.column.controls)},r}(at),lt=function(e){function r(t){void 0===t&&(t="");var r=e.call(this,4,"1.0")||this;return r.text=t,r}return(0,t.__extends)(r,e),Object.defineProperty(r.prototype,"text",{get:function(){return this._text},set:function(e){e.startsWith("<p>")||(e="<p>"+e+"</p>"),this._text=e},enumerable:!0,configurable:!0}),r.prototype.getControlData=function(){return{controlType:this.controlType,editorType:"CKEditor",id:this.id,position:{controlIndex:this.order,sectionFactor:this.column.factor,sectionIndex:this.column.order,zoneIndex:this.column.section.order}}},r.prototype.toHtml=function(e){this.order=e;var t=[];return t.push('<div data-sp-canvascontrol="" data-sp-canvasdataversion="'+this.dataVersion+'" data-sp-controldata="'+this.jsonData+'">'),t.push('<div data-sp-rte="">'),t.push(""+this.text),t.push("</div>"),t.push("</div>"),t.join("")},r.prototype.fromHtml=function(t){e.prototype.fromHtml.call(this,t);var r=/<div[^>]*data-sp-rte[^>]*>(.*?)<\/div>$/i.exec(t);this.text=r.length>1?r[1]:""},r}(pt),ct=function(e){function r(t,r,n,o,i,s,a){void 0===r&&(r=""),void 0===n&&(n={}),void 0===o&&(o=""),void 0===i&&(i=""),void 0===s&&(s=null),void 0===a&&(a="1.0");var u=e.call(this,3,"1.0")||this;return u.title=t,u.description=r,u.propertieJson=n,u.webPartId=o,u.htmlProperties=i,u.serverProcessedContent=s,u.canvasDataVersion=a,u}return(0,t.__extends)(r,e),r.fromComponentDef=function(e){var t=new r("");return t.import(e),t},r.prototype.import=function(e){this.webPartId=e.Id.replace(/^\{|\}$/g,"").toLowerCase();var t=JSON.parse(e.Manifest);this.title=t.preconfiguredEntries[0].title.default,this.description=t.preconfiguredEntries[0].description.default,this.dataVersion="",this.propertieJson=this.parseJsonProperties(t.preconfiguredEntries[0].properties)},r.prototype.setProperties=function(e){return this.propertieJson=(0,n.extend)(this.propertieJson,e),this},r.prototype.getProperties=function(){return this.propertieJson},r.prototype.toHtml=function(e){this.order=e;var t={dataVersion:this.dataVersion,description:this.description,id:this.webPartId,instanceId:this.id,properties:this.propertieJson,title:this.title},r=[];return r.push('<div data-sp-canvascontrol="" data-sp-canvasdataversion="'+this.canvasDataVersion+'" data-sp-controldata="'+this.jsonData+'">'),r.push('<div data-sp-webpart="" data-sp-webpartdataversion="'+this.dataVersion+'" data-sp-webpartdata="'+it.jsonToEscapedString(t)+'">'),r.push("<div data-sp-componentid>"),r.push(this.webPartId),r.push("</div>"),r.push('<div data-sp-htmlproperties="">'),r.push(this.renderHtmlProperties()),r.push("</div>"),r.push("</div>"),r.push("</div>"),r.join("")},r.prototype.fromHtml=function(t){e.prototype.fromHtml.call(this,t);var r=it.escapedStringToJson(Ye(t,"data-sp-webpartdata"));this.title=r.title,this.description=r.description,this.webPartId=r.id,this.canvasDataVersion=Ye(t,"data-sp-canvasdataversion"),this.dataVersion=Ye(t,"data-sp-webpartdataversion"),this.setProperties(r.properties),void 0!==r.serverProcessedContent&&(this.serverProcessedContent=r.serverProcessedContent);var n=et(t,/<div\b[^>]*data-sp-htmlproperties[^>]*?>/i,function(e){return e.replace(/^<div\b[^>]*data-sp-htmlproperties[^>]*?>/i,"").replace(/<\/div>$/i,"")});this.htmlProperties=n.length>0?n[0]:""},r.prototype.getControlData=function(){return{controlType:this.controlType,id:this.id,position:{controlIndex:this.order,sectionFactor:this.column.factor,sectionIndex:this.column.order,zoneIndex:this.column.section.order},webPartId:this.webPartId}},r.prototype.renderHtmlProperties=function(){var e=[];if(void 0===this.serverProcessedContent||null===this.serverProcessedContent)e.push(this.htmlProperties);else if(void 0!==this.serverProcessedContent){if(void 0!==this.serverProcessedContent.searchablePlainTexts)for(var t=Object.keys(this.serverProcessedContent.searchablePlainTexts),r=0;r<t.length;r++)e.push('<div data-sp-prop-name="'+t[r]+'" data-sp-searchableplaintext="true">'),e.push(this.serverProcessedContent.searchablePlainTexts[t[r]]),e.push("</div>");if(void 0!==this.serverProcessedContent.imageSources)for(t=Object.keys(this.serverProcessedContent.imageSources),r=0;r<t.length;r++)e.push('<img data-sp-prop-name="'+t[r]+'" src="'+this.serverProcessedContent.imageSources[t[r]]+'" />');if(void 0!==this.serverProcessedContent.links)for(t=Object.keys(this.serverProcessedContent.links),r=0;r<t.length;r++)e.push('<a data-sp-prop-name="'+t[r]+'" href="'+this.serverProcessedContent.links[t[r]]+'"></a>')}return e.join("")},r.prototype.parseJsonProperties=function(e){return void 0!==e.webPartData&&void 0!==e.webPartData.serverProcessedContent?this.serverProcessedContent=e.webPartData.serverProcessedContent:void 0!==e.serverProcessedContent?this.serverProcessedContent=e.serverProcessedContent:this.serverProcessedContent=null,void 0!==e.webPartData&&void 0!==e.webPartData.properties?e.webPartData.properties:void 0!==e.properties?e.properties:e},r}(pt),dt=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return(0,t.__extends)(r,e),r.prototype.getById=function(e){var t=new ht(this);return t.concat("("+e+")"),t},r.prototype.add=function(e,t,n){var o=this;void 0===n&&(n=!0);var i=JSON.stringify({IsVisible:n,Title:e,Url:t,__metadata:{type:"SP.NavigationNode"}});return this.clone(r,null).postCore({body:i}).then(function(e){return{data:e,node:o.getById(e.Id)}})},r.prototype.moveAfter=function(e,t){var n=JSON.stringify({nodeId:e,previousNodeId:t});return this.clone(r,"MoveAfter").postCore({body:n})},r}(_),ht=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return(0,t.__extends)(r,e),Object.defineProperty(r.prototype,"children",{get:function(){return new dt(this,"Children")},enumerable:!0,configurable:!0}),r.prototype.delete=function(){return e.prototype.deleteCore.call(this)},r}(O),ft=function(e){function r(t,r){return void 0===r&&(r="navigation"),e.call(this,t,r)||this}return(0,t.__extends)(r,e),Object.defineProperty(r.prototype,"quicklaunch",{get:function(){return new dt(this,"quicklaunch")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"topNavigationBar",{get:function(){return new dt(this,"topnavigationbar")},enumerable:!0,configurable:!0}),r}(I),yt=function(e){function r(t){return void 0===t&&(t=null),e.call(this,"_api/navigation",t)||this}return(0,t.__extends)(r,e),r.prototype.getMenuState=function(e,t,n,o){return void 0===e&&(e=null),void 0===t&&(t=10),void 0===n&&(n=null),void 0===o&&(o=null),new r("MenuState").postCore({body:JSON.stringify({customProperties:o,depth:t,mapProviderName:n,menuNodeKey:e})})},r.prototype.getMenuNodeKey=function(e,t){return void 0===t&&(t=null),new r("MenuNodeKey").postCore({body:JSON.stringify({currentUrl:e,mapProviderName:t})})},r}(I),gt=function(e){function r(t,r){return void 0===r&&(r="regionalsettings"),e.call(this,t,r)||this}return(0,t.__extends)(r,e),Object.defineProperty(r.prototype,"installedLanguages",{get:function(){return new mt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"globalInstalledLanguages",{get:function(){return new mt(this,"globalinstalledlanguages")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"timeZone",{get:function(){return new bt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"timeZones",{get:function(){return new vt(this)},enumerable:!0,configurable:!0}),r}(O),mt=function(e){function r(t,r){return void 0===r&&(r="installedlanguages"),e.call(this,t,r)||this}return(0,t.__extends)(r,e),r}(_),bt=function(e){function r(t,r){return void 0===r&&(r="timezone"),e.call(this,t,r)||this}return(0,t.__extends)(r,e),r.prototype.utcToLocalTime=function(e){var t;return t="string"==typeof e?e:e.toISOString(),this.clone(r,"utctolocaltime('"+t+"')").postCore().then(function(e){return e.hasOwnProperty("UTCToLocalTime")?e.UTCToLocalTime:e})},r.prototype.localTimeToUTC=function(e){var t;return t="string"==typeof e?e:(0,n.dateAdd)(e,"minute",-1*e.getTimezoneOffset()).toISOString(),this.clone(r,"localtimetoutc('"+t+"')").postCore().then(function(e){return e.hasOwnProperty("LocalTimeToUTC")?e.LocalTimeToUTC:e})},r}(O),vt=function(e){function r(t,r){return void 0===r&&(r="timezones"),e.call(this,t,r)||this}return(0,t.__extends)(r,e),r.prototype.getById=function(e){return this.clone(r,"GetById("+e+")").postCore({},y(bt))},r}(_),Pt=function(){function e(e,t){void 0===e&&(e=""),void 0===t&&(t={}),this._query=t,"string"==typeof e&&e.length>0&&this.extendQuery({Querytext:e})}return e.create=function(t,r){return void 0===t&&(t=""),void 0===r&&(r={}),new e(t,r)},e.prototype.text=function(e){return this.extendQuery({Querytext:e})},e.prototype.template=function(e){return this.extendQuery({QueryTemplate:e})},e.prototype.sourceId=function(e){return this.extendQuery({SourceId:e})},Object.defineProperty(e.prototype,"enableInterleaving",{get:function(){return this.extendQuery({EnableInterleaving:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableStemming",{get:function(){return this.extendQuery({EnableStemming:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"trimDuplicates",{get:function(){return this.extendQuery({TrimDuplicates:!0})},enumerable:!0,configurable:!0}),e.prototype.trimDuplicatesIncludeId=function(e){return this.extendQuery({TrimDuplicatesIncludeId:e})},Object.defineProperty(e.prototype,"enableNicknames",{get:function(){return this.extendQuery({EnableNicknames:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableFql",{get:function(){return this.extendQuery({EnableFQL:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enablePhonetic",{get:function(){return this.extendQuery({EnablePhonetic:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bypassResultTypes",{get:function(){return this.extendQuery({BypassResultTypes:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"processBestBets",{get:function(){return this.extendQuery({ProcessBestBets:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableQueryRules",{get:function(){return this.extendQuery({EnableQueryRules:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableSorting",{get:function(){return this.extendQuery({EnableSorting:!0})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"generateBlockRankLog",{get:function(){return this.extendQuery({GenerateBlockRankLog:!0})},enumerable:!0,configurable:!0}),e.prototype.rankingModelId=function(e){return this.extendQuery({RankingModelId:e})},e.prototype.startRow=function(e){return this.extendQuery({StartRow:e})},e.prototype.rowLimit=function(e){return this.extendQuery({RowLimit:e})},e.prototype.rowsPerPage=function(e){return this.extendQuery({RowsPerPage:e})},e.prototype.selectProperties=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.extendQuery({SelectProperties:e})},e.prototype.culture=function(e){return this.extendQuery({Culture:e})},e.prototype.timeZoneId=function(e){return this.extendQuery({TimeZoneId:e})},e.prototype.refinementFilters=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.extendQuery({RefinementFilters:e})},e.prototype.refiners=function(e){return this.extendQuery({Refiners:e})},e.prototype.hiddenConstraints=function(e){return this.extendQuery({HiddenConstraints:e})},e.prototype.sortList=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.extendQuery({SortList:e})},e.prototype.timeout=function(e){return this.extendQuery({Timeout:e})},e.prototype.hithighlightedProperties=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.extendQuery({HitHighlightedProperties:e})},e.prototype.clientType=function(e){return this.extendQuery({ClientType:e})},e.prototype.personalizationData=function(e){return this.extendQuery({PersonalizationData:e})},e.prototype.resultsURL=function(e){return this.extendQuery({ResultsUrl:e})},e.prototype.queryTag=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.extendQuery({QueryTag:e})},e.prototype.properties=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.extendQuery({Properties:e})},Object.defineProperty(e.prototype,"processPersonalFavorites",{get:function(){return this.extendQuery({ProcessPersonalFavorites:!0})},enumerable:!0,configurable:!0}),e.prototype.queryTemplatePropertiesUrl=function(e){return this.extendQuery({QueryTemplatePropertiesUrl:e})},e.prototype.reorderingRules=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.extendQuery({ReorderingRules:e})},e.prototype.hitHighlightedMultivaluePropertyLimit=function(e){return this.extendQuery({HitHighlightedMultivaluePropertyLimit:e})},Object.defineProperty(e.prototype,"enableOrderingHitHighlightedProperty",{get:function(){return this.extendQuery({EnableOrderingHitHighlightedProperty:!0})},enumerable:!0,configurable:!0}),e.prototype.collapseSpecification=function(e){return this.extendQuery({CollapseSpecification:e})},e.prototype.uiLanguage=function(e){return this.extendQuery({UILanguage:e})},e.prototype.desiredSnippetLength=function(e){return this.extendQuery({DesiredSnippetLength:e})},e.prototype.maxSnippetLength=function(e){return this.extendQuery({MaxSnippetLength:e})},e.prototype.summaryLength=function(e){return this.extendQuery({SummaryLength:e})},e.prototype.toSearchQuery=function(){return this._query},e.prototype.extendQuery=function(e){return this._query=(0,n.extend)(this._query,e),this},e}(),xt=function(e){function r(t,r){return void 0===r&&(r="_api/search/postquery"),e.call(this,t,r)||this}return(0,t.__extends)(r,e),r.prototype.execute=function(e){var t,r=this;(t=e).SelectProperties&&(t.SelectProperties=this.fixupProp(e.SelectProperties)),t.RefinementFilters&&(t.RefinementFilters=this.fixupProp(e.RefinementFilters)),t.SortList&&(t.SortList=this.fixupProp(e.SortList)),t.HithighlightedProperties&&(t.HithighlightedProperties=this.fixupProp(e.HitHighlightedProperties)),t.ReorderingRules&&(t.ReorderingRules=this.fixupProp(e.ReorderingRules)),t.Properties&&(t.Properties=this.fixupProp(e.Properties));var o=JSON.stringify({request:(0,n.extend)({__metadata:{type:"Microsoft.Office.Server.Search.REST.SearchRequest"}},t)});return this.postCore({body:o}).then(function(t){return new wt(t,r.toUrl(),e)})},r.prototype.fixupProp=function(e){return e.hasOwnProperty("results")?e:{results:e}},r}(O),wt=function(){function e(e,t,r,n,o){void 0===n&&(n=null),void 0===o&&(o=null),this._url=t,this._query=r,this._raw=n,this._primary=o,this._raw=e.postquery?e.postquery:e}return Object.defineProperty(e.prototype,"ElapsedTime",{get:function(){return this.RawSearchResults.ElapsedTime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"RowCount",{get:function(){return this.RawSearchResults.PrimaryQueryResult.RelevantResults.RowCount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TotalRows",{get:function(){return this.RawSearchResults.PrimaryQueryResult.RelevantResults.TotalRows},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TotalRowsIncludingDuplicates",{get:function(){return this.RawSearchResults.PrimaryQueryResult.RelevantResults.TotalRowsIncludingDuplicates},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"RawSearchResults",{get:function(){return this._raw},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"PrimarySearchResults",{get:function(){return null===this._primary&&(this._primary=this.formatSearchResults(this._raw.PrimaryQueryResult.RelevantResults.Table.Rows)),this._primary},enumerable:!0,configurable:!0}),e.prototype.getPage=function(e,t){if(this.TotalRows<this.RowCount)return Promise.resolve(null);var r=void 0!==t?t:this._query.hasOwnProperty("RowLimit")?this._query.RowLimit:10,o=(0,n.extend)(this._query,{RowLimit:r,StartRow:r*(e-1)});return o.StartRow>this.TotalRows?Promise.resolve(null):new xt(this._url,null).execute(o)},e.prototype.formatSearchResults=function(e){for(var t=new Array,r=0,n=e.results?e.results:e;r<n.length;r++){var o=n[r],i=o.Cells.results?o.Cells.results:o.Cells;t.push(i.reduce(function(e,t){return Object.defineProperty(e,t.Key,{configurable:!1,enumerable:!0,value:t.Value,writable:!1}),e},{}))}return t},e}();!function(e){e[e.Ascending=0]="Ascending",e[e.Descending=1]="Descending",e[e.FQLFormula=2]="FQLFormula"}(rt||(exports.SortDirection=rt={})),function(e){e[e.ResultContainsKeyword=0]="ResultContainsKeyword",e[e.TitleContainsKeyword=1]="TitleContainsKeyword",e[e.TitleMatchesKeyword=2]="TitleMatchesKeyword",e[e.UrlStartsWith=3]="UrlStartsWith",e[e.UrlExactlyMatches=4]="UrlExactlyMatches",e[e.ContentTypeIs=5]="ContentTypeIs",e[e.FileExtensionMatches=6]="FileExtensionMatches",e[e.ResultHasTag=7]="ResultHasTag",e[e.ManualCondition=8]="ManualCondition"}(nt||(exports.ReorderingRuleMatchType=nt={})),function(e){e[e.None=0]="None",e[e.StringType=1]="StringType",e[e.Int32Type=2]="Int32Type",e[e.BooleanType=3]="BooleanType",e[e.StringArrayType=4]="StringArrayType",e[e.UnSupportedType=5]="UnSupportedType"}(ot||(exports.QueryPropertyValueType=ot={}));var St=function(){function e(){}return e.Documents="e7ec8cee-ded8-43c9-beb5-436b54b31e84",e.ItemsMatchingContentType="5dc9f503-801e-4ced-8a2c-5d1237132419",e.ItemsMatchingTag="e1327b9c-2b8c-4b23-99c9-3730cb29c3f7",e.ItemsRelatedToCurrentUser="48fec42e-4a92-48ce-8363-c2703a40e67d",e.ItemsWithSameKeywordAsThisItem="5c069288-1d17-454a-8ac6-9c642a065f48",e.LocalPeopleResults="b09a7990-05ea-4af9-81ef-edfab16c4e31",e.LocalReportsAndDataResults="203fba36-2763-4060-9931-911ac8c0583b",e.LocalSharePointResults="8413cd39-2156-4e00-b54d-11efd9abdb89",e.LocalVideoResults="78b793ce-7956-4669-aa3b-451fc5defebf",e.Pages="5e34578e-4d08-4edc-8bf3-002acf3cdbcc",e.Pictures="38403c8c-3975-41a8-826e-717f2d41568a",e.Popular="97c71db1-58ce-4891-8b64-585bc2326c12",e.RecentlyChangedItems="ba63bbae-fa9c-42c0-b027-9a878f16557c",e.RecommendedItems="ec675252-14fa-4fbe-84dd-8d098ed74181",e.Wiki="9479bf85-e257-4318-b5a8-81a180f5faa1",e}(),Ct=function(e){function r(t,r){return void 0===r&&(r="_api/search/suggest"),e.call(this,t,r)||this}return(0,t.__extends)(r,e),r.prototype.execute=function(e){return this.mapQueryToQueryString(e),this.get().then(function(e){return new Tt(e)})},r.prototype.mapQueryToQueryString=function(e){this.query.add("querytext","'"+e.querytext+"'"),e.hasOwnProperty("count")&&this.query.add("inumberofquerysuggestions",e.count.toString()),e.hasOwnProperty("personalCount")&&this.query.add("inumberofresultsuggestions",e.personalCount.toString()),e.hasOwnProperty("preQuery")&&this.query.add("fprequerysuggestions",e.preQuery.toString()),e.hasOwnProperty("hitHighlighting")&&this.query.add("fhithighlighting",e.hitHighlighting.toString()),e.hasOwnProperty("capitalize")&&this.query.add("fcapitalizefirstletters",e.capitalize.toString()),e.hasOwnProperty("culture")&&this.query.add("culture",e.culture.toString()),e.hasOwnProperty("stemming")&&this.query.add("enablestemming",e.stemming.toString()),e.hasOwnProperty("includePeople")&&this.query.add("showpeoplenamesuggestions",e.includePeople.toString()),e.hasOwnProperty("queryRules")&&this.query.add("enablequeryrules",e.queryRules.toString()),e.hasOwnProperty("prefixMatch")&&this.query.add("fprefixmatchallterms",e.prefixMatch.toString())},r}(O),Tt=function(){return function(e){e.hasOwnProperty("suggest")?(this.PeopleNames=e.suggest.PeopleNames.results,this.PersonalResults=e.suggest.PersonalResults.results,this.Queries=e.suggest.Queries.results):(this.PeopleNames=e.PeopleNames,this.PersonalResults=e.PersonalResults,this.Queries=e.Queries)}}(),It=function(e){function o(t){var r=e.call(this)||this;return r.baseUrl=t,r}return(0,t.__extends)(o,e),o.ParseResponse=function(e){return new Promise(function(t,r){for(var n,o,i=[],a=new RegExp("^HTTP/[0-9.]+ +([0-9]+) +(.*)","i"),u=e.split("\n"),p="batch",l=0;l<u.length;++l){var c=u[l];switch(p){case"batch":if("--batchresponse_"===c.substr(0,"--batchresponse_".length))p="batchHeaders";else if(""!==c.trim())throw new s("Invalid response, line "+l);break;case"batchHeaders":""===c.trim()&&(p="status");break;case"status":var d=a.exec(c);if(3!==d.length)throw new s("Invalid status, line "+l);n=parseInt(d[1],10),o=d[2],p="statusHeaders";break;case"statusHeaders":""===c.trim()&&(p="body");break;case"body":i.push(204===n?new Response:new Response(c,{status:n,statusText:o})),p="batch"}}"status"!==p&&r(new s("Unexpected end of input")),t(i)})},o.prototype.executeImpl=function(){var e=this;if(r.Logger.write("["+this.batchId+"] ("+(new Date).getTime()+") Executing batch with "+this.requests.length+" requests.",1),this.requests.length<1)return r.Logger.write("Resolving empty batch.",1),Promise.resolve();var t=new S;return C(this.baseUrl).then(function(i){for(var a=[],u="",p=0;p<e.requests.length;p++){var l=e.requests[p];"GET"===l.method?(u.length>0&&(a.push("--changeset_"+u+"--\n\n"),u=""),a.push("--batch_"+e.batchId+"\n")):(u.length<1&&(u=(0,n.getGUID)(),a.push("--batch_"+e.batchId+"\n"),a.push('Content-Type: multipart/mixed; boundary="changeset_'+u+'"\n\n')),a.push("--changeset_"+u+"\n")),a.push("Content-Type: application/http\n"),a.push("Content-Transfer-Encoding: binary\n\n");var c=new Headers,d=(0,n.isUrlAbsolute)(l.url)?l.url:(0,n.combinePaths)(i,l.url);if(r.Logger.write("["+e.batchId+"] ("+(new Date).getTime()+") Adding request "+l.method+" "+d+" to batch.",0),"GET"!==l.method){var h=l.method,f=l.options.headers;l.hasOwnProperty("options")&&l.options.hasOwnProperty("headers")&&void 0!==f["X-HTTP-Method"]&&(h=f["X-HTTP-Method"],delete f["X-HTTP-Method"]),a.push(h+" "+d+" HTTP/1.1\n"),c.set("Content-Type","application/json;odata=verbose;charset=utf-8")}else a.push(l.method+" "+d+" HTTP/1.1\n");(0,n.mergeHeaders)(c,v.headers),l.options&&(0,n.mergeHeaders)(c,l.options.headers),c.has("Accept")||c.append("Accept","application/json"),c.has("Content-Type")||c.append("Content-Type","application/json;odata=verbose;charset=utf-8"),c.has("X-ClientService-ClientTag")||c.append("X-ClientService-ClientTag","PnPCoreJS:@pnp-$$Version$$"),c.forEach(function(e,t){a.push(t+": "+e+"\n")}),a.push("\n"),l.options.body&&a.push(l.options.body+"\n\n")}u.length>0&&(a.push("--changeset_"+u+"--\n\n"),u=""),a.push("--batch_"+e.batchId+"--\n");var y={body:a.join(""),headers:{"Content-Type":"multipart/mixed; boundary=batch_"+e.batchId},method:"POST"};return r.Logger.write("["+e.batchId+"] ("+(new Date).getTime()+") Sending batch request.",1),t.fetch((0,n.combinePaths)(i,"/_api/$batch"),y).then(function(e){return e.text()}).then(o.ParseResponse).then(function(t){if(t.length!==e.requests.length)throw new s("Could not properly parse responses to match requests in batch.");return r.Logger.write("["+e.batchId+"] ("+(new Date).getTime()+") Resolving batched requests.",1),t.reduce(function(t,n,o){var i=e.requests[o];return r.Logger.write("["+e.batchId+"] ("+(new Date).getTime()+") Resolving batched request "+i.method+" "+i.url+".",0),t.then(function(e){return i.parser.parse(n).then(i.resolve).catch(i.reject)})},Promise.resolve())})})},o}(o.ODataBatch),_t=function(e){function r(t,r){return void 0===r&&(r="features"),e.call(this,t,r)||this}return(0,t.__extends)(r,e),r.prototype.getById=function(e){var t=new Ot(this);return t.concat("('"+e+"')"),t},r.prototype.add=function(e,t){var n=this;return void 0===t&&(t=!1),this.clone(r,"add").postCore({body:JSON.stringify({featdefScope:0,featureId:e,force:t})}).then(function(t){return{data:t,feature:n.getById(e)}})},r.prototype.remove=function(e,t){return void 0===t&&(t=!1),this.clone(r,"remove").postCore({body:JSON.stringify({featureId:e,force:t})})},r}(_),Ot=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return(0,t.__extends)(r,e),r.prototype.deactivate=function(e){var t=this;void 0===e&&(e=!1);var n=this.addBatchDependency();return new r(this).select("DefinitionId").get().then(function(r){var o=t.getParent(_t,t.parentUrl,"",t.batch).remove(r.DefinitionId,e);return n(),o})},r}(O),Ft=function(e){function r(t,r){return void 0===r&&(r="_api/SP.RelatedItemManager"),e.call(this,t,r)||this}return(0,t.__extends)(r,e),r.FromUrl=function(e){if(null===e)return new r("");var t=e.indexOf("_api/");return new r(t>-1?e.substr(0,t):e)},r.prototype.getRelatedItems=function(e,t){var n=this.clone(r,null);return n.concat(".GetRelatedItems"),n.postCore({body:JSON.stringify({SourceItemID:t,SourceListName:e})})},r.prototype.getPageOneRelatedItems=function(e,t){var n=this.clone(r,null);return n.concat(".GetPageOneRelatedItems"),n.postCore({body:JSON.stringify({SourceItemID:t,SourceListName:e})})},r.prototype.addSingleLink=function(e,t,n,o,i,s,a){void 0===a&&(a=!1);var u=this.clone(r,null);return u.concat(".AddSingleLink"),u.postCore({body:JSON.stringify({SourceItemID:t,SourceListName:e,SourceWebUrl:n,TargetItemID:i,TargetListName:o,TargetWebUrl:s,TryAddReverseLink:a})})},r.prototype.addSingleLinkToUrl=function(e,t,n,o){void 0===o&&(o=!1);var i=this.clone(r,null);return i.concat(".AddSingleLinkToUrl"),i.postCore({body:JSON.stringify({SourceItemID:t,SourceListName:e,TargetItemUrl:n,TryAddReverseLink:o})})},r.prototype.addSingleLinkFromUrl=function(e,t,n,o){void 0===o&&(o=!1);var i=this.clone(r,null);return i.concat(".AddSingleLinkFromUrl"),i.postCore({body:JSON.stringify({SourceItemUrl:e,TargetItemID:n,TargetListName:t,TryAddReverseLink:o})})},r.prototype.deleteSingleLink=function(e,t,n,o,i,s,a){void 0===a&&(a=!1);var u=this.clone(r,null);return u.concat(".DeleteSingleLink"),u.postCore({body:JSON.stringify({SourceItemID:t,SourceListName:e,SourceWebUrl:n,TargetItemID:i,TargetListName:o,TargetWebUrl:s,TryDeleteReverseLink:a})})},r}(I),Dt=function(e){function r(t,r){return void 0===r&&(r="webs"),e.call(this,t,r)||this}return(0,t.__extends)(r,e),r.prototype.add=function(e,t,o,i,s,a){void 0===o&&(o=""),void 0===i&&(i="STS"),void 0===s&&(s=1033),void 0===a&&(a=!0);var u={Description:o,Language:s,Title:e,Url:t,UseSamePermissionsAsParentSite:a,WebTemplate:i},p=JSON.stringify({parameters:(0,n.extend)({__metadata:{type:"SP.WebCreationInformation"}},u)});return this.clone(r,"add").postCore({body:p}).then(function(e){return{data:e,web:new Lt(c(e).replace(/_api\/web\/?/i,""))}})},r}(_),Rt=function(e){function r(t,r){return void 0===r&&(r="webinfos"),e.call(this,t,r)||this}return(0,t.__extends)(r,e),r}(_),Lt=function(e){function r(t,r){return void 0===r&&(r="_api/web"),e.call(this,t,r)||this}return(0,t.__extends)(r,e),r.fromUrl=function(e,t){return new r(i(e),t)},Object.defineProperty(r.prototype,"webs",{get:function(){return new Dt(this)},enumerable:!0,configurable:!0}),r.prototype.getSubwebsFilteredForCurrentUser=function(e,t){return void 0===e&&(e=-1),void 0===t&&(t=-1),this.clone(Dt,"getSubwebsFilteredForCurrentUser(nWebTemplateFilter="+e+",nConfigurationFilter="+t+")")},Object.defineProperty(r.prototype,"allProperties",{get:function(){return this.clone(_,"allproperties")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"webinfos",{get:function(){return new Rt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"contentTypes",{get:function(){return new ve(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"lists",{get:function(){return new Ne(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"fields",{get:function(){return new Oe(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"features",{get:function(){return new _t(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"availablefields",{get:function(){return new Oe(this,"availablefields")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"navigation",{get:function(){return new ft(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"siteUsers",{get:function(){return new F(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"siteGroups",{get:function(){return new X(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"siteUserInfoList",{get:function(){return new je(this,"siteuserinfolist")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"regionalSettings",{get:function(){return new gt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"currentUser",{get:function(){return new R(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"folders",{get:function(){return new me(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"userCustomActions",{get:function(){return new Be(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"roleDefinitions",{get:function(){return new Y(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"relatedItems",{get:function(){return Ft.FromUrl(this.toUrl())},enumerable:!0,configurable:!0}),r.prototype.createBatch=function(){return new It(this.parentUrl)},Object.defineProperty(r.prototype,"rootFolder",{get:function(){return new be(this,"rootFolder")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"associatedOwnerGroup",{get:function(){return new z(this,"associatedownergroup")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"associatedMemberGroup",{get:function(){return new z(this,"associatedmembergroup")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"associatedVisitorGroup",{get:function(){return new z(this,"associatedvisitorgroup")},enumerable:!0,configurable:!0}),r.prototype.getFolderByServerRelativeUrl=function(e){return new be(this,"getFolderByServerRelativeUrl('"+e+"')")},r.prototype.getFolderByServerRelativePath=function(e){return new be(this,"getFolderByServerRelativePath(decodedUrl='"+e+"')")},r.prototype.getFileByServerRelativeUrl=function(e){return new We(this,"getFileByServerRelativeUrl('"+e+"')")},r.prototype.getFileByServerRelativePath=function(e){return new We(this,"getFileByServerRelativePath(decodedUrl='"+e+"')")},r.prototype.getList=function(e){return new je(this,"getList('"+e+"')")},r.prototype.update=function(e){var t=this,r=JSON.stringify((0,n.extend)({__metadata:{type:"SP.Web"}},e));return this.postCore({body:r,headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{data:e,web:t}})},r.prototype.delete=function(){return e.prototype.deleteCore.call(this)},r.prototype.applyTheme=function(e,t,n,o){var i=JSON.stringify({backgroundImageUrl:n,colorPaletteUrl:e,fontSchemeUrl:t,shareGenerated:o});return this.clone(r,"applytheme").postCore({body:i})},r.prototype.applyWebTemplate=function(e){var t=this.clone(r,"applywebtemplate");return t.concat("(@t)"),t.query.add("@t",e),t.postCore()},r.prototype.ensureUser=function(e){var t=JSON.stringify({logonName:e});return this.clone(r,"ensureuser").postCore({body:t}).then(function(e){return{data:e,user:new D(c(e))}})},r.prototype.availableWebTemplates=function(e,t){return void 0===e&&(e=1033),void 0===t&&(t=!0),new _(this,"getavailablewebtemplates(lcid="+e+", doincludecrosslanguage="+t+")")},r.prototype.getCatalog=function(e){return this.clone(r,"getcatalog("+e+")").select("Id").get().then(function(e){return new je(c(e))})},r.prototype.getChanges=function(e){var t=JSON.stringify({query:(0,n.extend)({__metadata:{type:"SP.ChangeQuery"}},e)});return this.clone(r,"getchanges").postCore({body:t})},Object.defineProperty(r.prototype,"customListTemplate",{get:function(){return new _(this,"getcustomlisttemplates")},enumerable:!0,configurable:!0}),r.prototype.getUserById=function(e){return new D(this,"getUserById("+e+")")},r.prototype.mapToIcon=function(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=""),this.clone(r,"maptoicon(filename='"+e+"', progid='"+n+"', size="+t+")").get()},r.prototype.getStorageEntity=function(e){return this.clone(r,"getStorageEntity('"+e+"')").get()},r.prototype.setStorageEntity=function(e,t,n,o){return void 0===n&&(n=""),void 0===o&&(o=""),this.clone(r,"setStorageEntity").postCore({body:JSON.stringify({comments:o,description:n,key:e,value:t})})},r.prototype.removeStorageEntity=function(e){return this.clone(r,"removeStorageEntity('"+e+"')").postCore()},r.prototype.getAppCatalog=function(e){return new Xe(e||this)},r.prototype.getClientSideWebParts=function(){return this.clone(_,"GetClientSideWebParts").get()},r.prototype.addClientSidePage=function(e,t,r){return void 0===t&&(t=e.replace(/\.[^/.]+$/,"")),void 0===r&&(r="Site Pages"),it.create(this.lists.getByTitle(r),e,t)},r}(ue),Ut=function(e){function r(t,r){return void 0===r&&(r="_api/site"),e.call(this,t,r)||this}return(0,t.__extends)(r,e),Object.defineProperty(r.prototype,"rootWeb",{get:function(){return new Lt(this,"rootweb")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"features",{get:function(){return new _t(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"userCustomActions",{get:function(){return new Be(this)},enumerable:!0,configurable:!0}),r.prototype.getContextInfo=function(){return new r(this.parentUrl,"_api/contextinfo").postCore().then(function(e){if(e.hasOwnProperty("GetContextWebInformation")){var t=e.GetContextWebInformation;return t.SupportedSchemaVersions=t.SupportedSchemaVersions.results,t}return e})},r.prototype.getDocumentLibraries=function(e){var t=new I("","_api/sp.web.getdocumentlibraries(@v)");return t.query.add("@v","'"+e+"'"),t.get().then(function(e){return e.hasOwnProperty("GetDocumentLibraries")?e.GetDocumentLibraries:e})},r.prototype.getWebUrlFromPageUrl=function(e){var t=new I("","_api/sp.web.getweburlfrompageurl(@v)");return t.query.add("@v","'"+e+"'"),t.get().then(function(e){return e.hasOwnProperty("GetWebUrlFromPageUrl")?e.GetWebUrlFromPageUrl:e})},r.prototype.createBatch=function(){return new It(this.parentUrl)},r.prototype.openWebById=function(e){return this.clone(r,"openWebById('"+e+"')").postCore().then(function(e){return{data:e,web:Lt.fromUrl(c(e))}})},r}(O),Bt=function(e){function r(t,r){void 0===r&&(r="_api/sp.userprofiles.peoplemanager");var n=e.call(this,t,r)||this;return n.clientPeoplePickerQuery=new Nt(t),n.profileLoader=new Et(t),n}return(0,t.__extends)(r,e),Object.defineProperty(r.prototype,"editProfileLink",{get:function(){return this.clone(r,"EditProfileLink").get()},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"isMyPeopleListPublic",{get:function(){return this.clone(r,"IsMyPeopleListPublic").get()},enumerable:!0,configurable:!0}),r.prototype.amIFollowedBy=function(e){var t=this.clone(r,"amifollowedby(@v)");return t.query.add("@v","'"+encodeURIComponent(e)+"'"),t.get()},r.prototype.amIFollowing=function(e){var t=this.clone(r,"amifollowing(@v)");return t.query.add("@v","'"+encodeURIComponent(e)+"'"),t.get()},r.prototype.getFollowedTags=function(e){return void 0===e&&(e=20),this.clone(r,"getfollowedtags("+e+")").get()},r.prototype.getFollowersFor=function(e){var t=this.clone(r,"getfollowersfor(@v)");return t.query.add("@v","'"+encodeURIComponent(e)+"'"),t.get()},Object.defineProperty(r.prototype,"myFollowers",{get:function(){return new _(this,"getmyfollowers")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"myProperties",{get:function(){return new r(this,"getmyproperties")},enumerable:!0,configurable:!0}),r.prototype.getPeopleFollowedBy=function(e){var t=this.clone(r,"getpeoplefollowedby(@v)");return t.query.add("@v","'"+encodeURIComponent(e)+"'"),t.get()},r.prototype.getPropertiesFor=function(e){var t=this.clone(r,"getpropertiesfor(@v)");return t.query.add("@v","'"+encodeURIComponent(e)+"'"),t.get()},Object.defineProperty(r.prototype,"trendingTags",{get:function(){var e=this.clone(r,null);return e.concat(".gettrendingtags"),e.get()},enumerable:!0,configurable:!0}),r.prototype.getUserProfilePropertyFor=function(e,t){var n=this.clone(r,"getuserprofilepropertyfor(accountname=@v, propertyname='"+t+"')");return n.query.add("@v","'"+encodeURIComponent(e)+"'"),n.get()},r.prototype.hideSuggestion=function(e){var t=this.clone(r,"hidesuggestion(@v)");return t.query.add("@v","'"+encodeURIComponent(e)+"'"),t.postCore()},r.prototype.isFollowing=function(e,t){var n=this.clone(r,null);return n.concat(".isfollowing(possiblefolloweraccountname=@v, possiblefolloweeaccountname=@y)"),n.query.add("@v","'"+encodeURIComponent(e)+"'"),n.query.add("@y","'"+encodeURIComponent(t)+"'"),n.get()},r.prototype.setMyProfilePic=function(e){var t=this;return new Promise(function(o,i){(0,n.readBlobAsArrayBuffer)(e).then(function(e){new r(t,"setmyprofilepicture").postCore({body:String.fromCharCode.apply(null,new Uint16Array(e))}).then(function(e){return o()})}).catch(function(e){return i(e)})})},r.prototype.setSingleValueProfileProperty=function(e,t,n){var o=JSON.stringify({accountName:e,propertyName:t,propertyValue:n});return this.clone(r,"SetSingleValueProfileProperty").postCore({body:o})},r.prototype.setMultiValuedProfileProperty=function(e,t,n){var o=JSON.stringify({accountName:e,propertyName:t,propertyValues:n});return this.clone(r,"SetMultiValuedProfileProperty").postCore({body:o})},r.prototype.createPersonalSiteEnqueueBulk=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.profileLoader.createPersonalSiteEnqueueBulk(e)},Object.defineProperty(r.prototype,"ownerUserProfile",{get:function(){return this.profileLoader.ownerUserProfile},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"userProfile",{get:function(){return this.profileLoader.userProfile},enumerable:!0,configurable:!0}),r.prototype.createPersonalSite=function(e){return void 0===e&&(e=!1),this.profileLoader.createPersonalSite(e)},r.prototype.shareAllSocialData=function(e){return this.profileLoader.shareAllSocialData(e)},r.prototype.clientPeoplePickerResolveUser=function(e){return this.clientPeoplePickerQuery.clientPeoplePickerResolveUser(e)},r.prototype.clientPeoplePickerSearchUser=function(e){return this.clientPeoplePickerQuery.clientPeoplePickerSearchUser(e)},r}(O),Et=function(e){function r(t,r){return void 0===r&&(r="_api/sp.userprofiles.profileloader.getprofileloader"),e.call(this,t,r)||this}return(0,t.__extends)(r,e),r.prototype.createPersonalSiteEnqueueBulk=function(e){return this.clone(r,"createpersonalsiteenqueuebulk",!1).postCore({body:JSON.stringify({emailIDs:e})})},Object.defineProperty(r.prototype,"ownerUserProfile",{get:function(){var e=this.getParent(r,this.parentUrl,"_api/sp.userprofiles.profileloader.getowneruserprofile");return this.hasBatch&&(e=e.inBatch(this.batch)),e.postCore()},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"userProfile",{get:function(){return this.clone(r,"getuserprofile").postCore()},enumerable:!0,configurable:!0}),r.prototype.createPersonalSite=function(e){return void 0===e&&(e=!1),this.clone(r,"getuserprofile/createpersonalsiteenque("+e+")").postCore()},r.prototype.shareAllSocialData=function(e){return this.clone(r,"getuserprofile/shareallsocialdata("+e+")").postCore()},r}(I),Nt=function(e){function r(t,r){return void 0===r&&(r="_api/sp.ui.applicationpages.clientpeoplepickerwebserviceinterface"),e.call(this,t,r)||this}return(0,t.__extends)(r,e),r.prototype.clientPeoplePickerResolveUser=function(e){var t=this.clone(r,null);return t.concat(".clientpeoplepickerresolveuser"),t.postCore({body:this.createClientPeoplePickerQueryParametersRequestBody(e)}).then(function(e){return JSON.parse(e)})},r.prototype.clientPeoplePickerSearchUser=function(e){var t=this.clone(r,null);return t.concat(".clientpeoplepickersearchuser"),t.postCore({body:this.createClientPeoplePickerQueryParametersRequestBody(e)}).then(function(e){return JSON.parse(e)})},r.prototype.createClientPeoplePickerQueryParametersRequestBody=function(e){return JSON.stringify({queryParams:(0,n.extend)({__metadata:{type:"SP.UI.ApplicationPages.ClientPeoplePickerQueryParameters"}},e)})},r}(I),jt=function(e){function r(t,r){return void 0===r&&(r="_api/social.following"),e.call(this,t,r)||this}return(0,t.__extends)(r,e),Object.defineProperty(r.prototype,"my",{get:function(){return new At(this)},enumerable:!0,configurable:!0}),r.prototype.getFollowedSitesUri=function(){return this.clone(r,"FollowedSitesUri").get().then(function(e){return e.FollowedSitesUri||e})},r.prototype.getFollowedDocumentsUri=function(){return this.clone(r,"FollowedDocumentsUri").get().then(function(e){return e.FollowedDocumentsUri||e})},r.prototype.follow=function(e){return this.clone(r,"follow").postCore({body:this.createSocialActorInfoRequestBody(e)})},r.prototype.isFollowed=function(e){return this.clone(r,"isfollowed").postCore({body:this.createSocialActorInfoRequestBody(e)})},r.prototype.stopFollowing=function(e){return this.clone(r,"stopfollowing").postCore({body:this.createSocialActorInfoRequestBody(e)})},r.prototype.createSocialActorInfoRequestBody=function(e){return JSON.stringify({actor:(0,n.extend)({Id:null,__metadata:{type:"SP.Social.SocialActorInfo"}},e)})},r}(O),At=function(e){function r(t,r){return void 0===r&&(r="my"),e.call(this,t,r)||this}return(0,t.__extends)(r,e),r.prototype.followed=function(e){return this.clone(r,"followed(types="+e+")").get().then(function(e){return e.hasOwnProperty("Followed")?e.Followed.results:e})},r.prototype.followedCount=function(e){return this.clone(r,"followedcount(types="+e+")").get().then(function(e){return e.FollowedCount||e})},r.prototype.followers=function(){return this.clone(r,"followers").get().then(function(e){return e.hasOwnProperty("Followers")?e.Followers.results:e})},r.prototype.suggestions=function(){return this.clone(r,"suggestions").get().then(function(e){return e.hasOwnProperty("Suggestions")?e.Suggestions.results:e})},r}(O),kt=function(e){function r(t,n){return e.call(this,r.getBaseUrl(t),"_api/SP.Utilities.Utility."+n)||this}return(0,t.__extends)(r,e),r.getBaseUrl=function(e){if("string"==typeof e)return e;var t=e.toUrl(),r=t.indexOf("_api/");return r<0?t:t.substr(0,r)},r.prototype.excute=function(e){return this.postCore({body:JSON.stringify(e)})},r.prototype.sendEmail=function(e){var t={properties:{Body:e.Body,From:e.From,Subject:e.Subject,__metadata:{type:"SP.Utilities.EmailProperties"}}};return e.To&&e.To.length>0&&(t.properties=(0,n.extend)(t.properties,{To:{results:e.To}})),e.CC&&e.CC.length>0&&(t.properties=(0,n.extend)(t.properties,{CC:{results:e.CC}})),e.BCC&&e.BCC.length>0&&(t.properties=(0,n.extend)(t.properties,{BCC:{results:e.BCC}})),e.AdditionalHeaders&&(t.properties=(0,n.extend)(t.properties,{AdditionalHeaders:e.AdditionalHeaders})),this.clone(r,"SendEmail",!0).excute(t)},r.prototype.getCurrentUserEmailAddresses=function(){return this.clone(r,"GetCurrentUserEmailAddresses",!0).excute({})},r.prototype.resolvePrincipal=function(e,t,n,o,i,s){void 0===s&&(s=!1);var a={addToUserInfoList:i,input:e,inputIsEmailOnly:o,matchUserInfoList:s,scopes:t,sources:n};return this.clone(r,"ResolvePrincipalInCurrentContext",!0).excute(a)},r.prototype.searchPrincipals=function(e,t,n,o,i){var s={groupName:o,input:e,maxCount:i,scopes:t,sources:n};return this.clone(r,"SearchPrincipalsUsingContextWeb",!0).excute(s)},r.prototype.createEmailBodyForInvitation=function(e){var t={pageAddress:e};return this.clone(r,"CreateEmailBodyForInvitation",!0).excute(t)},r.prototype.expandGroupsToPrincipals=function(e,t){void 0===t&&(t=30);var n={inputs:e,maxCount:t};return this.clone(r,"ExpandGroupsToPrincipals",!0).excute(n)},r.prototype.createWikiPage=function(e){return this.clone(r,"CreateWikiPageInContextWeb",!0).excute({parameters:e}).then(function(e){return{data:e,file:new We(c(e))}})},r}(I),Mt=function(){function e(e,t){void 0===e&&(e={}),void 0===t&&(t=""),this._options=e,this._baseUrl=t}return e.prototype.configure=function(t,r){return void 0===r&&(r=""),new e(t,r)},e.prototype.setup=function(e){m(e)},e.prototype.searchSuggest=function(e){var t;return t="string"==typeof e?{querytext:e}:e,this.create(Ct).execute(t)},e.prototype.search=function(e){var t;return t="string"==typeof e?{Querytext:e}:e instanceof Pt?e.toSearchQuery():e,this.create(xt).execute(t)},Object.defineProperty(e.prototype,"site",{get:function(){return this.create(Ut)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"web",{get:function(){return this.create(Lt)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"profiles",{get:function(){return this.create(Bt)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"social",{get:function(){return this.create(jt)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"navigation",{get:function(){return new yt},enumerable:!0,configurable:!0}),e.prototype.createBatch=function(){return this.web.createBatch()},Object.defineProperty(e.prototype,"utility",{get:function(){return this.create(kt,"")},enumerable:!0,configurable:!0}),e.prototype.create=function(e,t){return new e(this._baseUrl,t).configure(this._options)},e}(),qt=new Mt;exports.spExtractODataId=c,exports.spODataEntity=y,exports.spODataEntityArray=g,exports.SharePointQueryable=I,exports.SharePointQueryableInstance=O,exports.SharePointQueryableCollection=_,exports.SharePointQueryableSecurable=se,exports.FileFolderShared=le,exports.SharePointQueryableShareable=ae,exports.SharePointQueryableShareableFile=ce,exports.SharePointQueryableShareableFolder=de,exports.SharePointQueryableShareableItem=pe,exports.SharePointQueryableShareableWeb=ue,exports.AppCatalog=Xe,exports.App=ze,exports.ContentType=Pe,exports.ContentTypes=ve,exports.FieldLink=we,exports.FieldLinks=xe,exports.Field=Fe,exports.Fields=Oe,exports.CheckinType=re,exports.WebPartsPersonalizationScope=ne,exports.MoveOperations=oe,exports.TemplateFileType=ie,exports.File=We,exports.Files=Je,exports.Folder=be,exports.Folders=me,exports.SPHttpClient=S,exports.Item=ke,exports.Items=Ae,exports.ItemVersion=qe,exports.ItemVersions=Me,exports.PagedItemCollection=Qe,exports.NavigationNodes=dt,exports.NavigationNode=ht,exports.NavigationService=yt,exports.List=je,exports.Lists=Ne,exports.RegionalSettings=gt,exports.InstalledLanguages=mt,exports.TimeZone=bt,exports.TimeZones=vt,exports.sp=qt,exports.SPRest=Mt,exports.RoleDefinitionBindings=te,exports.Search=xt,exports.SearchQueryBuilder=Pt,exports.SearchResults=wt,exports.SortDirection=rt,exports.ReorderingRuleMatchType=nt,exports.QueryPropertyValueType=ot,exports.SearchBuiltInSourceId=St,exports.SearchSuggest=Ct,exports.SearchSuggestResult=Tt,exports.Site=Ut,exports.UtilityMethod=kt,exports.WebPartDefinitions=fe,exports.WebPartDefinition=ye,exports.WebPart=ge,exports.Web=Lt,exports.ClientSidePage=it,exports.CanvasSection=st,exports.CanvasControl=at,exports.CanvasColumn=ut,exports.ClientSidePart=pt,exports.ClientSideText=lt,exports.ClientSideWebpart=ct,exports.SocialQuery=jt,exports.MySocialQuery=At,exports.ControlMode=L,exports.FieldTypes=U,exports.DateTimeFieldFormatType=B,exports.AddFieldOptions=E,exports.CalendarType=N,exports.UrlFieldFormatType=j,exports.PermissionKind=A,exports.RoleType=k,exports.PageType=M,exports.SharingLinkKind=q,exports.SharingRole=Q,exports.SharingOperationStatusCode=H,exports.SPSharedObjectType=V,exports.SharingDomainRestrictionMode=J,exports.RenderListDataOptions=W,exports.FieldUserSelectionMode=G,exports.ChoiceFieldFormatType=K;
},{"tslib":8,"@pnp/logging":6,"@pnp/common":7,"@pnp/odata":9}],2:[function(require,module,exports) {
"use strict";var e=require("@pnp/sp");e.sp.setup({sp:{headers:{Accept:"application/json;odata=verbose"},baseUrl:"http://spdev"}}),e.sp.web.currentUser.get().then(function(s){console.log(s),e.sp.web.siteUsers.getById(1073741823).groups.filter("LoginName eq 'TestGroup'").get().then(function(e){var s=e.length>0?"TestGroup":null;console.log(s)})});
},{"@pnp/sp":4}]},{},[2])
//# sourceMappingURL=/sp-grp-mem-pnp.38a30cdc.map